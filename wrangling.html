
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cleaning and wrangling data &#8212; DSCΙ 100</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/style.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Effective data visualization" href="viz.html" />
    <link rel="prev" title="Reading in data locally and from the web" href="reading.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">DSCΙ 100</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="index.html">
   Welcome – TBD
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  First draft
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="preface-text.html">
   Preface – TBD
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="foreword-text.html">
   Foreword – TBD
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="acknowledgements.html">
   Acknowledgments – TBD
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="authors.html">
   About the authors – TBD
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="setup.html">
   Setting up your computer – TBD
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Python and the Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="reading.html">
   Reading in data locally and from the web
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Cleaning and wrangling data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="viz.html">
   Effective data visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="classification1.html">
   Classification I: training &amp; predicting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="classification2.html">
   Classification II: evaluation &amp; tuning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="regression1.html">
   Regression I: K-nearest neighbors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="regression2.html">
   Regression II: linear regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="clustering.html">
   Clustering – TBD
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="inference.html">
   Statistical inference
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="references.html">
   References – TBD
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="appendixA.html">
   Appendix
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="_sources/wrangling.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/wrangling.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-learning-objectives">
   Chapter learning objectives
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-frames-series-and-lists">
   Data frames, series, and lists
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-is-a-data-frame">
     What is a data frame?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-is-a-series">
     What is a series?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-is-a-list">
     What is a list?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-does-this-have-to-do-with-data-frames">
     What does this have to do with data frames?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tidy-data">
   Tidy data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tidying-up-going-from-wide-to-long-using-melt">
     Tidying up: going from wide to long using
     <code class="docutils literal notranslate">
      <span class="pre">
       .melt
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tidying-up-going-from-long-to-wide-using-pivot">
     Tidying up: going from long to wide using
     <code class="docutils literal notranslate">
      <span class="pre">
       .pivot
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tidying-up-using-str-split-to-deal-with-multiple-delimiters">
     Tidying up: using
     <code class="docutils literal notranslate">
      <span class="pre">
       .str.split
      </span>
     </code>
     to deal with multiple delimiters
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-loc-and-iloc-to-extract-a-range-of-columns">
   Using
   <code class="docutils literal notranslate">
    <span class="pre">
     .loc[]
    </span>
   </code>
   and
   <code class="docutils literal notranslate">
    <span class="pre">
     .iloc[]
    </span>
   </code>
   to extract a range of columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-df-to-extract-rows">
   Using
   <code class="docutils literal notranslate">
    <span class="pre">
     df[]
    </span>
   </code>
   to extract rows
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extracting-rows-that-have-a-certain-value-with">
     Extracting rows that have a certain value with
     <code class="docutils literal notranslate">
      <span class="pre">
       ==
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extracting-rows-that-do-not-have-a-certain-value-with">
     Extracting rows that do not have a certain value with
     <code class="docutils literal notranslate">
      <span class="pre">
       !=
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extracting-rows-satisfying-multiple-conditions-using">
     Extracting rows satisfying multiple conditions using
     <code class="docutils literal notranslate">
      <span class="pre">
       &amp;
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extracting-rows-satisfying-at-least-one-condition-using">
     Extracting rows satisfying at least one condition using
     <code class="docutils literal notranslate">
      <span class="pre">
       |
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extracting-rows-with-values-in-a-list-using-isin">
     Extracting rows with values in a list using
     <code class="docutils literal notranslate">
      <span class="pre">
       .isin()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extracting-rows-above-or-below-a-threshold-using-and">
     Extracting rows above or below a threshold using
     <code class="docutils literal notranslate">
      <span class="pre">
       &gt;
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       &lt;
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-assign-to-modify-or-add-columns">
   Using
   <code class="docutils literal notranslate">
    <span class="pre">
     .assign
    </span>
   </code>
   to modify or add columns
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-assign-to-modify-columns">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       .assign
      </span>
     </code>
     to modify columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-assign-to-create-new-columns">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       .assign
      </span>
     </code>
     to create new columns
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#combining-functions-by-chaining-the-methods">
   Combining functions by chaining the methods
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#chaining-df-and-loc">
     Chaining
     <code class="docutils literal notranslate">
      <span class="pre">
       df[]
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       .loc
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#chaining-more-than-two-functions">
     Chaining more than two functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aggregating-data-with-assign-agg-and-apply">
   Aggregating data with
   <code class="docutils literal notranslate">
    <span class="pre">
     .assign
    </span>
   </code>
   ,
   <code class="docutils literal notranslate">
    <span class="pre">
     .agg
    </span>
   </code>
   and
   <code class="docutils literal notranslate">
    <span class="pre">
     .apply
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-summary-statistics-on-whole-columns">
     Calculating summary statistics on whole columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-summary-statistics-when-there-are-nans">
     Calculating summary statistics when there are
     <code class="docutils literal notranslate">
      <span class="pre">
       NaN
      </span>
     </code>
     s
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-summary-statistics-for-groups-of-rows">
     Calculating summary statistics for groups of rows
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-summary-statistics-on-many-columns">
     Calculating summary statistics on many columns
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#aggregating-on-a-data-frame-for-calculating-summary-statistics-on-many-columns">
       Aggregating on a data frame for calculating summary statistics on many columns
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#apply-for-calculating-summary-statistics-on-many-columns">
       <code class="docutils literal notranslate">
        <span class="pre">
         .apply
        </span>
       </code>
       for calculating summary statistics on many columns
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#apply-functions-across-many-columns-with-apply">
   Apply functions across many columns with
   <code class="docutils literal notranslate">
    <span class="pre">
     .apply
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#apply-functions-across-columns-within-one-row-with-apply">
   Apply functions across columns within one row with
   <code class="docutils literal notranslate">
    <span class="pre">
     .apply
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#additional-resources">
   Additional resources
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Cleaning and wrangling data</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#chapter-learning-objectives">
   Chapter learning objectives
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-frames-series-and-lists">
   Data frames, series, and lists
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-is-a-data-frame">
     What is a data frame?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-is-a-series">
     What is a series?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-is-a-list">
     What is a list?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-does-this-have-to-do-with-data-frames">
     What does this have to do with data frames?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tidy-data">
   Tidy data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tidying-up-going-from-wide-to-long-using-melt">
     Tidying up: going from wide to long using
     <code class="docutils literal notranslate">
      <span class="pre">
       .melt
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tidying-up-going-from-long-to-wide-using-pivot">
     Tidying up: going from long to wide using
     <code class="docutils literal notranslate">
      <span class="pre">
       .pivot
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tidying-up-using-str-split-to-deal-with-multiple-delimiters">
     Tidying up: using
     <code class="docutils literal notranslate">
      <span class="pre">
       .str.split
      </span>
     </code>
     to deal with multiple delimiters
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-loc-and-iloc-to-extract-a-range-of-columns">
   Using
   <code class="docutils literal notranslate">
    <span class="pre">
     .loc[]
    </span>
   </code>
   and
   <code class="docutils literal notranslate">
    <span class="pre">
     .iloc[]
    </span>
   </code>
   to extract a range of columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-df-to-extract-rows">
   Using
   <code class="docutils literal notranslate">
    <span class="pre">
     df[]
    </span>
   </code>
   to extract rows
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extracting-rows-that-have-a-certain-value-with">
     Extracting rows that have a certain value with
     <code class="docutils literal notranslate">
      <span class="pre">
       ==
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extracting-rows-that-do-not-have-a-certain-value-with">
     Extracting rows that do not have a certain value with
     <code class="docutils literal notranslate">
      <span class="pre">
       !=
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extracting-rows-satisfying-multiple-conditions-using">
     Extracting rows satisfying multiple conditions using
     <code class="docutils literal notranslate">
      <span class="pre">
       &amp;
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extracting-rows-satisfying-at-least-one-condition-using">
     Extracting rows satisfying at least one condition using
     <code class="docutils literal notranslate">
      <span class="pre">
       |
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extracting-rows-with-values-in-a-list-using-isin">
     Extracting rows with values in a list using
     <code class="docutils literal notranslate">
      <span class="pre">
       .isin()
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extracting-rows-above-or-below-a-threshold-using-and">
     Extracting rows above or below a threshold using
     <code class="docutils literal notranslate">
      <span class="pre">
       &gt;
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       &lt;
      </span>
     </code>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#using-assign-to-modify-or-add-columns">
   Using
   <code class="docutils literal notranslate">
    <span class="pre">
     .assign
    </span>
   </code>
   to modify or add columns
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-assign-to-modify-columns">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       .assign
      </span>
     </code>
     to modify columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#using-assign-to-create-new-columns">
     Using
     <code class="docutils literal notranslate">
      <span class="pre">
       .assign
      </span>
     </code>
     to create new columns
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#combining-functions-by-chaining-the-methods">
   Combining functions by chaining the methods
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#chaining-df-and-loc">
     Chaining
     <code class="docutils literal notranslate">
      <span class="pre">
       df[]
      </span>
     </code>
     and
     <code class="docutils literal notranslate">
      <span class="pre">
       .loc
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#chaining-more-than-two-functions">
     Chaining more than two functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aggregating-data-with-assign-agg-and-apply">
   Aggregating data with
   <code class="docutils literal notranslate">
    <span class="pre">
     .assign
    </span>
   </code>
   ,
   <code class="docutils literal notranslate">
    <span class="pre">
     .agg
    </span>
   </code>
   and
   <code class="docutils literal notranslate">
    <span class="pre">
     .apply
    </span>
   </code>
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-summary-statistics-on-whole-columns">
     Calculating summary statistics on whole columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-summary-statistics-when-there-are-nans">
     Calculating summary statistics when there are
     <code class="docutils literal notranslate">
      <span class="pre">
       NaN
      </span>
     </code>
     s
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-summary-statistics-for-groups-of-rows">
     Calculating summary statistics for groups of rows
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-summary-statistics-on-many-columns">
     Calculating summary statistics on many columns
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#aggregating-on-a-data-frame-for-calculating-summary-statistics-on-many-columns">
       Aggregating on a data frame for calculating summary statistics on many columns
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#apply-for-calculating-summary-statistics-on-many-columns">
       <code class="docutils literal notranslate">
        <span class="pre">
         .apply
        </span>
       </code>
       for calculating summary statistics on many columns
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#apply-functions-across-many-columns-with-apply">
   Apply functions across many columns with
   <code class="docutils literal notranslate">
    <span class="pre">
     .apply
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#apply-functions-across-columns-within-one-row-with-apply">
   Apply functions across columns within one row with
   <code class="docutils literal notranslate">
    <span class="pre">
     .apply
    </span>
   </code>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   Exercises
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#additional-resources">
   Additional resources
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="cleaning-and-wrangling-data">
<h1>Cleaning and wrangling data<a class="headerlink" href="#cleaning-and-wrangling-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This chapter is centered around defining tidy data—a data format that is
suitable for analysis—and the tools needed to transform raw data into this
format. This will be presented in the context of a real-world data science
application, providing more practice working through a whole case study.</p>
</div>
<div class="section" id="chapter-learning-objectives">
<h2>Chapter learning objectives<a class="headerlink" href="#chapter-learning-objectives" title="Permalink to this headline">¶</a></h2>
<p>By the end of the chapter, readers will be able to do the following:</p>
<ul class="simple">
<li><p>Define the term “tidy data”.</p></li>
<li><p>Discuss the advantages of storing data in a tidy data format.</p></li>
<li><p>Define what lists, series and data frames are in Python, and describe how they relate to
each other.</p></li>
<li><p>Describe the common types of data in Python and their uses.</p></li>
<li><p>Recall and use the following functions for their
intended data wrangling tasks:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">.agg</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.apply</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.assign</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.groupby</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.melt</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.pivot</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.str.split</span></code></p></li>
</ul>
</li>
<li><p>Recall and use the following operators for their
intended data wrangling tasks:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">==</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">in</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">and</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">or</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">df[]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">.loc[]</span></code></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="data-frames-series-and-lists">
<h2>Data frames, series, and lists<a class="headerlink" href="#data-frames-series-and-lists" title="Permalink to this headline">¶</a></h2>
<p>In Chapters <span class="xref std std-ref">intro</span> and <span class="xref std std-ref">reading</span>, <em>data frames</em> were the focus:
we learned how to import data into Python as a data frame, and perform basic operations on data frames in Python.
In the remainder of this book, this pattern continues. The vast majority of tools we use will require
that data are represented as a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <strong>data frame</strong> in Python. Therefore, in this section,
we will dig more deeply into what data frames are and how they are represented in Python.
This knowledge will be helpful in effectively utilizing these objects in our data analyses.</p>
<div class="section" id="what-is-a-data-frame">
<h3>What is a data frame?<a class="headerlink" href="#what-is-a-data-frame" title="Permalink to this headline">¶</a></h3>
<p>A data frame \index{data frame!definition} is a table-like structure for storing data in Python.  Data frames are
important to learn about because most data that you will encounter in practice
can be naturally stored as a table.  In order to define data frames precisely,
we need to introduce a few technical terms:</p>
<ul class="simple">
<li><p><strong>variable:</strong> a \index{variable} characteristic, number, or quantity that can be measured.</p></li>
<li><p><strong>observation:</strong> all \index{observation} of the measurements for a given entity.</p></li>
<li><p><strong>value:</strong> a \index{value} single measurement of a single variable for a given entity.</p></li>
</ul>
<p>Given these definitions, a <strong>data frame</strong> is a tabular data structure in Python
that is designed to store observations, variables, and their values.
Most commonly, each column in a data frame corresponds to a variable,
and each row corresponds to an observation. For example,
<a class="reference internal" href="#fig-02-obs"><span class="std std-numref">Fig. 12</span></a> displays a data set of city populations. Here, the variables
are “region, year, population”; each of these are properties that can be
collected or measured.  The first observation is “Toronto, 2016, 2235145”;
these are the values that the three variables take for the first entity in the
data set. There are 13 entities in the data set in total, corresponding to the
13 rows in <a class="reference internal" href="#fig-02-obs"><span class="std std-numref">Fig. 12</span></a>.</p>
<div class="caption-hack figure align-default" id="fig-02-obs">
<img alt="_images/data_frame_slides_cdn.004.jpeg" src="_images/data_frame_slides_cdn.004.jpeg" />
<p class="caption"><span class="caption-number">Fig. 12 </span><span class="caption-text">A data frame storing data regarding the population of various regions in Canada. In this example data frame, the row that corresponds to the observation for the city of Vancouver is colored yellow, and the column that corresponds to the population variable is colored blue.</span><a class="headerlink" href="#fig-02-obs" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="what-is-a-series">
<h3>What is a series?<a class="headerlink" href="#what-is-a-series" title="Permalink to this headline">¶</a></h3>
<p>In Python, <code class="docutils literal notranslate"><span class="pre">pandas</span></code> <strong>series</strong> are arrays with labels. They are strictly 1-dimensional and can contain any data type (integers, strings, floats, etc), including a mix of them (objects);
Python has several different basic data types, as shown in <a class="reference internal" href="#tab-datatype-table"><span class="std std-numref">Table 3</span></a>.
You can create a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> series using the <code class="docutils literal notranslate"><span class="pre">pd.Series()</span></code> function.  For
example, to create the vector <code class="docutils literal notranslate"><span class="pre">region</span></code> as shown in
<a class="reference internal" href="#fig-02-series"><span class="std std-numref">Fig. 13</span></a>, you can write:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">region</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;Toronto&quot;</span><span class="p">,</span> <span class="s2">&quot;Montreal&quot;</span><span class="p">,</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">,</span> <span class="s2">&quot;Calgary&quot;</span><span class="p">,</span> <span class="s2">&quot;Ottawa&quot;</span><span class="p">])</span>
<span class="n">region</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      Toronto
1     Montreal
2    Vancouver
3      Calgary
4       Ottawa
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="caption-hack figure align-default" id="fig-02-series">
<img alt="_images/pandas_dataframe_series.png" src="_images/pandas_dataframe_series.png" />
<p class="caption"><span class="caption-number">Fig. 13 </span><span class="caption-text">Example of a <code class="docutils literal notranslate"><span class="pre">pandas</span></code> series whose type is string.</span><a class="headerlink" href="#fig-02-series" title="Permalink to this image">¶</a></p>
</div>
<p>\newpage</p>
<table class="colwidths-auto table" id="tab-datatype-table">
<caption><span class="caption-number">Table 3 </span><span class="caption-text">Basic data types in Python</span><a class="headerlink" href="#tab-datatype-table" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="text-align:left head"><p>English name</p></th>
<th class="text-align:left head"><p>Type name</p></th>
<th class="text-align:left head"><p>Type Category</p></th>
<th class="text-align:left head"><p>Description</p></th>
<th class="text-align:left head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:left"><p>integer</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p></td>
<td class="text-align:left"><p>Numeric Type</p></td>
<td class="text-align:left"><p>positive/negative whole numbers</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">42</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>floating point number</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">float</span></code></p></td>
<td class="text-align:left"><p>Numeric Type</p></td>
<td class="text-align:left"><p>real number in decimal form</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">3.14159</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>boolean</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p></td>
<td class="text-align:left"><p>Boolean Values</p></td>
<td class="text-align:left"><p>true or false</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">True</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>string</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">str</span></code></p></td>
<td class="text-align:left"><p>Sequence Type</p></td>
<td class="text-align:left"><p>text</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">&quot;Can</span> <span class="pre">I</span> <span class="pre">have</span> <span class="pre">a</span> <span class="pre">cheezburger?&quot;</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>list</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">list</span></code></p></td>
<td class="text-align:left"><p>Sequence Type</p></td>
<td class="text-align:left"><p>a collection of objects - mutable &amp; ordered</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">['Ali',</span> <span class="pre">'Xinyi',</span> <span class="pre">'Miriam']</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>tuple</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">tuple</span></code></p></td>
<td class="text-align:left"><p>Sequence Type</p></td>
<td class="text-align:left"><p>a collection of objects - immutable &amp; ordered</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">('Thursday',</span> <span class="pre">6,</span> <span class="pre">9,</span> <span class="pre">2018)</span></code></p></td>
</tr>
<tr class="row-even"><td class="text-align:left"><p>dictionary</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p></td>
<td class="text-align:left"><p>Mapping Type</p></td>
<td class="text-align:left"><p>mapping of key-value pairs</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">{'name':'DSCI',</span> <span class="pre">'code':100,</span> <span class="pre">'credits':2}</span></code></p></td>
</tr>
<tr class="row-odd"><td class="text-align:left"><p>none</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">NoneType</span></code></p></td>
<td class="text-align:left"><p>Null Object</p></td>
<td class="text-align:left"><p>represents no value</p></td>
<td class="text-align:left"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
</tr>
</tbody>
</table>
<p>\index{data types}
\index{character}\index{chr|see{character}}
\index{integer}\index{int|see{integer}}
\index{double}\index{dbl|see{double}}
\index{logical}\index{lgl|see{logical}}
\index{factor}\index{fct|see{factor}}
It is important in Python to make sure you represent your data with the correct type.
Many of the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> functions we use in this book treat
the various data types differently. You should use integers and float types
(which both fall under the “numeric” umbrella type) to represent numbers and perform
arithmetic. Strings are used to represent data that should
be thought of as “text”, such as words, names, paths, URLs, and more.
There are other basic data types in Python, such as <em>set</em>
and <em>complex</em>, but we do not use these in this textbook.</p>
</div>
<div class="section" id="what-is-a-list">
<h3>What is a list?<a class="headerlink" href="#what-is-a-list" title="Permalink to this headline">¶</a></h3>
<p>Lists \index{list} are built-in objects in Python that have multiple, ordered elements.
<code class="docutils literal notranslate"><span class="pre">pandas</span></code> series can be treated as lists with labels (indices).</p>
</div>
<div class="section" id="what-does-this-have-to-do-with-data-frames">
<h3>What does this have to do with data frames?<a class="headerlink" href="#what-does-this-have-to-do-with-data-frames" title="Permalink to this headline">¶</a></h3>
<p>A data frame \index{data frame!definition} is really just series stuck together that follows two rules:</p>
<ol class="simple">
<li><p>Each element itself is a series.</p></li>
<li><p>Each element (series) must have the same length.</p></li>
</ol>
<p>Not all columns in a data frame need to be of the same type.
<a class="reference internal" href="#fig-02-dataframe"><span class="std std-numref">Fig. 14</span></a> shows a data frame where
the columns are series of different types.</p>
<div class="caption-hack figure align-default" id="fig-02-dataframe">
<img alt="_images/pandas_dataframe_series-3.png" src="_images/pandas_dataframe_series-3.png" />
<p class="caption"><span class="caption-number">Fig. 14 </span><span class="caption-text">Data frame and vector types.</span><a class="headerlink" href="#fig-02-dataframe" title="Permalink to this image">¶</a></p>
</div>
<blockquote>
<div><p><strong>Note:</strong> You can use the function <code class="docutils literal notranslate"><span class="pre">type</span></code> \index{class} on a data object.
For example we can check the class of the Canadian languages data set,
<code class="docutils literal notranslate"><span class="pre">can_lang</span></code>, we worked with in the previous chapters and we see it is a <code class="docutils literal notranslate"><span class="pre">pandas.core.frame.DataFrame</span></code>.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">can_lang</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/can_lang.csv&quot;</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">can_lang</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="nn">Input In [10],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">can_lang</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/can_lang.csv&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="nb">type</span><span class="p">(</span><span class="n">can_lang</span><span class="p">)</span>

<span class="nn">File ~/opt/miniconda3/envs/dsci/lib/python3.9/site-packages/pandas/util/_decorators.py:311,</span> in <span class="ni">deprecate_nonkeyword_arguments.&lt;locals&gt;.decorate.&lt;locals&gt;.wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">305</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">num_allow_args</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">306</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">307</span>         <span class="n">msg</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">arguments</span><span class="o">=</span><span class="n">arguments</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">308</span>         <span class="ne">FutureWarning</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">309</span>         <span class="n">stacklevel</span><span class="o">=</span><span class="n">stacklevel</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">310</span>     <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">311</span> <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/opt/miniconda3/envs/dsci/lib/python3.9/site-packages/pandas/io/parsers/readers.py:680,</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, squeeze, prefix, mangle_dupe_cols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, error_bad_lines, warn_bad_lines, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">665</span> <span class="n">kwds_defaults</span> <span class="o">=</span> <span class="n">_refine_defaults_read</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">666</span>     <span class="n">dialect</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">667</span>     <span class="n">delimiter</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">676</span>     <span class="n">defaults</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;delimiter&quot;</span><span class="p">:</span> <span class="s2">&quot;,&quot;</span><span class="p">},</span>
<span class="g g-Whitespace">    </span><span class="mi">677</span> <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">678</span> <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">680</span> <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>

<span class="nn">File ~/opt/miniconda3/envs/dsci/lib/python3.9/site-packages/pandas/io/parsers/readers.py:575,</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">572</span> <span class="n">_validate_names</span><span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">574</span> <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">575</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">577</span> <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">578</span>     <span class="k">return</span> <span class="n">parser</span>

<span class="nn">File ~/opt/miniconda3/envs/dsci/lib/python3.9/site-packages/pandas/io/parsers/readers.py:933,</span> in <span class="ni">TextFileReader.__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">930</span>     <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">932</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="p">:</span> <span class="n">IOHandles</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">--&gt; </span><span class="mi">933</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>

<span class="nn">File ~/opt/miniconda3/envs/dsci/lib/python3.9/site-packages/pandas/io/parsers/readers.py:1217,</span> in <span class="ni">TextFileReader._make_engine</span><span class="nt">(self, f, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1213</span>     <span class="n">mode</span> <span class="o">=</span> <span class="s2">&quot;rb&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1214</span> <span class="c1"># error: No overload variant of &quot;get_handle&quot; matches argument types</span>
<span class="g g-Whitespace">   </span><span class="mi">1215</span> <span class="c1"># &quot;Union[str, PathLike[str], ReadCsvBuffer[bytes], ReadCsvBuffer[str]]&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1216</span> <span class="c1"># , &quot;str&quot;, &quot;bool&quot;, &quot;Any&quot;, &quot;Any&quot;, &quot;Any&quot;, &quot;Any&quot;, &quot;Any&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1217</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="o">=</span> <span class="n">get_handle</span><span class="p">(</span>  <span class="c1"># type: ignore[call-overload]</span>
<span class="g g-Whitespace">   </span><span class="mi">1218</span>     <span class="n">f</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1219</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1220</span>     <span class="n">encoding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1221</span>     <span class="n">compression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;compression&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1222</span>     <span class="n">memory_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1223</span>     <span class="n">is_text</span><span class="o">=</span><span class="n">is_text</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1224</span>     <span class="n">errors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding_errors&quot;</span><span class="p">,</span> <span class="s2">&quot;strict&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1225</span>     <span class="n">storage_options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1226</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1227</span> <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1228</span> <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="o">.</span><span class="n">handle</span>

<span class="nn">File ~/opt/miniconda3/envs/dsci/lib/python3.9/site-packages/pandas/io/common.py:789,</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">784</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">785</span>     <span class="c1"># Check whether the filename is to be opened in binary mode.</span>
<span class="g g-Whitespace">    </span><span class="mi">786</span>     <span class="c1"># Binary mode does not support &#39;encoding&#39; and &#39;newline&#39;.</span>
<span class="g g-Whitespace">    </span><span class="mi">787</span>     <span class="k">if</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">and</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">788</span>         <span class="c1"># Encoding</span>
<span class="ne">--&gt; </span><span class="mi">789</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">790</span>             <span class="n">handle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">791</span>             <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">792</span>             <span class="n">encoding</span><span class="o">=</span><span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">793</span>             <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">794</span>             <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">795</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">796</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">797</span>         <span class="c1"># Binary mode</span>
<span class="g g-Whitespace">    </span><span class="mi">798</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;data/can_lang.csv&#39;
</pre></div>
</div>
</div>
</div>
<p>Lists, Series and DataFrames are basic types of <em>data structure</em> in Python, which
are core to most data analyses. We summarize them in
<a class="reference internal" href="#tab-datastructure-table"><span class="std std-numref">Table 4</span></a>. There are several other data structures in the Python programming
language (<em>e.g.,</em> matrices), but these are beyond the scope of this book.</p>
<table class="colwidths-auto table" id="tab-datastructure-table">
<caption><span class="caption-number">Table 4 </span><span class="caption-text">Basic data structures in Python</span><a class="headerlink" href="#tab-datastructure-table" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Data Structure</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>list</p></td>
<td><p>An 1D ordered collection of values that can store multiple data types at once.</p></td>
</tr>
<tr class="row-odd"><td><p>Series</p></td>
<td><p>An 1D ordered collection of values <em>with labels</em> that can store multiple data types at once.</p></td>
</tr>
<tr class="row-even"><td><p>DataFrame</p></td>
<td><p>A 2D labeled data structure with columns of potentially different types.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="tidy-data">
<h2>Tidy data<a class="headerlink" href="#tidy-data" title="Permalink to this headline">¶</a></h2>
<p>There are many ways a tabular data set can be organized. This chapter will focus
on introducing the <strong>tidy data</strong> \index{tidy data!definition} format of organization and how to make your raw
(and likely messy) data tidy. A tidy data frame satisfies
the following three criteria <span id="id1">[<a class="reference internal" href="regression2.html#id20" title="Hadley Wickham. Tidy data. Journal of Statistical Software, 59(10):1–23, 2014.">Wickham, 2014</a>]</span>:</p>
<ul class="simple">
<li><p>each row is a single observation,</p></li>
<li><p>each column is a single variable, and</p></li>
<li><p>each value is a single cell (i.e., its entry in the data
frame is not shared with another value).</p></li>
</ul>
<p><a class="reference internal" href="#fig-02-tidy-image"><span class="std std-numref">Fig. 15</span></a> demonstrates a tidy data set that satisfies these
three criteria.</p>
<div class="caption-hack figure align-default" id="fig-02-tidy-image">
<img alt="_images/tidy_data.001-cropped.jpeg" src="_images/tidy_data.001-cropped.jpeg" />
<p class="caption"><span class="caption-number">Fig. 15 </span><span class="caption-text">Tidy data satisfies three criteria.</span><a class="headerlink" href="#fig-02-tidy-image" title="Permalink to this image">¶</a></p>
</div>
<p>There are many good reasons for making sure your data are tidy as a first step in your analysis.
The most important is that it is a single, consistent format that nearly every function
in the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> recognizes. No matter what the variables and observations
in your data represent, as long as the data frame \index{tidy data!arguments for}
is tidy, you can manipulate it, plot it, and analyze it using the same tools.
If your data is <em>not</em> tidy, you will have to write special bespoke code
in your analysis that will not only be error-prone, but hard for others to understand.
Beyond making your analysis more accessible to others and less error-prone, tidy data
is also typically easy for humans to interpret. Given these benefits,
it is well worth spending the time to get your data into a tidy format
upfront. Fortunately, there are many well-designed <code class="docutils literal notranslate"><span class="pre">pandas</span></code> data
cleaning/wrangling tools to help you easily tidy your data. Let’s explore them
below!</p>
<blockquote>
<div><p><strong>Note:</strong> Is there only one shape for tidy data for a given data set? Not
necessarily! It depends on the statistical question you are asking and what
the variables are for that question. For tidy data, each variable should be
its own column. So, just as it’s essential to match your statistical question
with the appropriate data analysis tool, it’s important to match your
statistical question with the appropriate variables and ensure they are
represented as individual columns to make the data tidy.</p>
</div></blockquote>
<div class="section" id="tidying-up-going-from-wide-to-long-using-melt">
<h3>Tidying up: going from wide to long using <code class="docutils literal notranslate"><span class="pre">.melt</span></code><a class="headerlink" href="#tidying-up-going-from-wide-to-long-using-melt" title="Permalink to this headline">¶</a></h3>
<p>One task that is commonly performed to get data into a tidy format \index{pivot_longer}
is to combine values that are stored in separate columns,
but are really part of the same variable, into one.
Data is often stored this way
because this format is sometimes more intuitive for human readability
and understanding, and humans create data sets.
In <a class="reference internal" href="#fig-02-wide-to-long"><span class="std std-numref">Fig. 16</span></a>,
the table on the left is in an untidy, “wide” format because the year values
(2006, 2011, 2016) are stored as column names.
And as a consequence,
the values for population for the various cities
over these years are also split across several columns.</p>
<p>For humans, this table is easy to read, which is why you will often find data
stored in this wide format.  However, this format is difficult to work with
when performing data visualization or statistical analysis using Python.  For
example, if we wanted to find the latest year it would be challenging because
the year values are stored as column names instead of as values in a single
column.  So before we could apply a function to find the latest year (for
example, by using <code class="docutils literal notranslate"><span class="pre">max</span></code>), we would have to first extract the column names
to get them as a list and then apply a function to extract the latest year.
The problem only gets worse if you would like to find the value for the
population for a given region for the latest year.  Both of these tasks are
greatly simplified once the data is tidied.</p>
<p>Another problem with data in this format is that we don’t know what the
numbers under each year actually represent. Do those numbers represent
population size? Land area? It’s not clear.
To solve both of these problems,
we can reshape this data set to a tidy data format
by creating a column called “year” and a column called
“population.” This transformation—which makes the data
“longer”—is shown as the right table in
<a class="reference internal" href="#fig-02-wide-to-long"><span class="std std-numref">Fig. 16</span></a>.</p>
<div class="caption-hack figure align-default" id="fig-02-wide-to-long">
<img alt="_images/pivot_functions.001.jpeg" src="_images/pivot_functions.001.jpeg" />
<p class="caption"><span class="caption-number">Fig. 16 </span><span class="caption-text">Melting data from a wide to long data format.</span><a class="headerlink" href="#fig-02-wide-to-long" title="Permalink to this image">¶</a></p>
</div>
<p>We can achieve this effect in Python using the <code class="docutils literal notranslate"><span class="pre">.melt</span></code> function from the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> package.
The <code class="docutils literal notranslate"><span class="pre">.melt</span></code> function combines columns,
and is usually used during tidying data
when we need to make the data frame longer and narrower.
To learn how to use <code class="docutils literal notranslate"><span class="pre">.melt</span></code>, we will work through an example with the
<code class="docutils literal notranslate"><span class="pre">region_lang_top5_cities_wide.csv</span></code> data set. This data set contains the
counts of how many Canadians cited each language as their mother tongue for five
major Canadian cities (Toronto, Montréal, Vancouver, Calgary and Edmonton) from
the 2016 Canadian census.  \index{Canadian languages}
To get started,
we will use <code class="docutils literal notranslate"><span class="pre">pd.read_csv</span></code> to load the (untidy) data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lang_wide</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/region_lang_top5_cities_wide.csv&quot;</span><span class="p">)</span>
<span class="n">lang_wide</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>Toronto</th>
      <th>Montréal</th>
      <th>Vancouver</th>
      <th>Calgary</th>
      <th>Edmonton</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>80</td>
      <td>30</td>
      <td>70</td>
      <td>20</td>
      <td>25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afrikaans</td>
      <td>985</td>
      <td>90</td>
      <td>1435</td>
      <td>960</td>
      <td>575</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>360</td>
      <td>240</td>
      <td>45</td>
      <td>45</td>
      <td>65</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Akan (Twi)</td>
      <td>8485</td>
      <td>1015</td>
      <td>400</td>
      <td>705</td>
      <td>885</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Albanian</td>
      <td>13260</td>
      <td>2450</td>
      <td>1090</td>
      <td>1365</td>
      <td>770</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>209</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wolof</td>
      <td>165</td>
      <td>2440</td>
      <td>30</td>
      <td>120</td>
      <td>130</td>
    </tr>
    <tr>
      <th>210</th>
      <td>Aboriginal languages</td>
      <td>Woods Cree</td>
      <td>5</td>
      <td>0</td>
      <td>20</td>
      <td>10</td>
      <td>155</td>
    </tr>
    <tr>
      <th>211</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
      <td>5290</td>
      <td>1025</td>
      <td>4330</td>
      <td>380</td>
      <td>235</td>
    </tr>
    <tr>
      <th>212</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
      <td>3355</td>
      <td>8960</td>
      <td>220</td>
      <td>80</td>
      <td>55</td>
    </tr>
    <tr>
      <th>213</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>3380</td>
      <td>210</td>
      <td>190</td>
      <td>1430</td>
      <td>700</td>
    </tr>
  </tbody>
</table>
<p>214 rows × 7 columns</p>
</div></div></div>
</div>
<p>What is wrong with the untidy format above?
The table on the left in <a class="reference internal" href="#fig-img-pivot-longer-with-table"><span class="std std-numref">Fig. 17</span></a>
represents the data in the “wide” (messy) format.
From a data analysis perspective, this format is not ideal because the values of
the variable <em>region</em> (Toronto, Montréal, Vancouver, Calgary and Edmonton)
are stored as column names. Thus they
are not easily accessible to the data analysis functions we will apply
to our data set. Additionally, the <em>mother tongue</em> variable values are
spread across multiple columns, which will prevent us from doing any desired
visualization or statistical tasks until we combine them into one column. For
instance, suppose we want to know the languages with the highest number of
Canadians reporting it as their mother tongue among all five regions. This
question would be tough to answer with the data in its current format.
We <em>could</em> find the answer with the data in this format,
though it would be much easier to answer if we tidy our
data first. If mother tongue were instead stored as one column,
as shown in the tidy data on the right in
<a class="reference internal" href="#fig-img-pivot-longer-with-table"><span class="std std-numref">Fig. 17</span></a>,
we could simply use one line of code (<code class="docutils literal notranslate"><span class="pre">df[&quot;mother_tongue&quot;].max()</span></code>)
to get the maximum value.</p>
<div class="caption-hack figure align-default" id="fig-img-pivot-longer-with-table">
<img alt="_images/pandas_melt_wide-long.png" src="_images/pandas_melt_wide-long.png" />
<p class="caption"><span class="caption-number">Fig. 17 </span><span class="caption-text">Going from wide to long with the <code class="docutils literal notranslate"><span class="pre">.melt</span></code> function.</span><a class="headerlink" href="#fig-img-pivot-longer-with-table" title="Permalink to this image">¶</a></p>
</div>
<p><a class="reference internal" href="#fig-img-pivot-longer"><span class="std std-numref">Fig. 18</span></a> details the arguments that we need to specify
in the <code class="docutils literal notranslate"><span class="pre">.melt</span></code> function to accomplish this data transformation.</p>
<div class="caption-hack figure align-default" id="fig-img-pivot-longer">
<img alt="_images/pandas_melt_args_labels.png" src="_images/pandas_melt_args_labels.png" />
<p class="caption"><span class="caption-number">Fig. 18 </span><span class="caption-text">Syntax for the <code class="docutils literal notranslate"><span class="pre">melt</span></code> function.</span><a class="headerlink" href="#fig-img-pivot-longer" title="Permalink to this image">¶</a></p>
</div>
<p>We use <code class="docutils literal notranslate"><span class="pre">.melt</span></code> to combine the Toronto, Montréal,
Vancouver, Calgary, and Edmonton columns into a single column called <code class="docutils literal notranslate"><span class="pre">region</span></code>,
and create a column called <code class="docutils literal notranslate"><span class="pre">mother_tongue</span></code> that contains the count of how many
Canadians report each language as their mother tongue for each metropolitan
area. We specify <code class="docutils literal notranslate"><span class="pre">value_vars</span></code> to be all
the columns between Toronto and Edmonton:  \index{column range}\index{aaacolonsymb&#64;\texttt{:}|see{column range}}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lang_mother_tidy</span> <span class="o">=</span> <span class="n">lang_wide</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
    <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;language&quot;</span><span class="p">],</span>
    <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Toronto&quot;</span><span class="p">,</span> <span class="s2">&quot;Montréal&quot;</span><span class="p">,</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">,</span> <span class="s2">&quot;Calgary&quot;</span><span class="p">,</span> <span class="s2">&quot;Edmonton&quot;</span><span class="p">],</span>
    <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
    <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;mother_tongue&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">lang_mother_tidy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>mother_tongue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>80</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>985</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>360</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>8485</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>13260</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wolof</td>
      <td>Edmonton</td>
      <td>130</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Aboriginal languages</td>
      <td>Woods Cree</td>
      <td>Edmonton</td>
      <td>155</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
      <td>Edmonton</td>
      <td>235</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
      <td>Edmonton</td>
      <td>55</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>Edmonton</td>
      <td>700</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 4 columns</p>
</div></div></div>
</div>
<blockquote>
<div><p><strong>Note</strong>: In the code above, the call to the
<code class="docutils literal notranslate"><span class="pre">.melt</span></code> function is split across several lines. This is allowed in
certain cases; for example, when calling a function as above, as long as the
line ends with a comma <code class="docutils literal notranslate"><span class="pre">,</span></code> Python knows to keep reading on the next line.
Splitting long lines like this across multiple lines is encouraged
as it helps significantly with code readability. Generally speaking, you should
limit each line of code to about 80 characters.</p>
</div></blockquote>
<p>The data above is now tidy because all three criteria for tidy data have now
been met:</p>
<ol class="simple">
<li><p>All the variables (<code class="docutils literal notranslate"><span class="pre">category</span></code>, <code class="docutils literal notranslate"><span class="pre">language</span></code>, <code class="docutils literal notranslate"><span class="pre">region</span></code> and <code class="docutils literal notranslate"><span class="pre">mother_tongue</span></code>) are
now their own columns in the data frame.</p></li>
<li><p>Each observation, i.e., each <code class="docutils literal notranslate"><span class="pre">category</span></code>, <code class="docutils literal notranslate"><span class="pre">language</span></code>, <code class="docutils literal notranslate"><span class="pre">region</span></code>, and count of
Canadians where that language is the mother tongue, are in a single row.</p></li>
<li><p>Each value is a single cell, i.e., its row, column position in the data
frame is not shared with another value.</p></li>
</ol>
</div>
<div class="section" id="tidying-up-going-from-long-to-wide-using-pivot">
<span id="pivot-wider"></span><h3>Tidying up: going from long to wide using <code class="docutils literal notranslate"><span class="pre">.pivot</span></code><a class="headerlink" href="#tidying-up-going-from-long-to-wide-using-pivot" title="Permalink to this headline">¶</a></h3>
<p>Suppose we have observations spread across multiple rows rather than in a single \index{pivot_wider}
row. For example, in <a class="reference internal" href="#fig-long-to-wide"><span class="std std-numref">Fig. 19</span></a>, the table on the left is in an
untidy, long format because the <code class="docutils literal notranslate"><span class="pre">count</span></code> column contains three variables
(population, commuter, and incorporated count) and information about each observation
(here, population, commuter, and incorporated counts for a region) is split across three rows.
Remember: one of the criteria for tidy data
is that each observation must be in a single row.</p>
<p>Using data in this format—where two or more variables are mixed together
in a single column—makes it harder to apply many usual <code class="docutils literal notranslate"><span class="pre">pandas</span></code> functions.
For example, finding the maximum number of commuters
would require an additional step of filtering for the commuter values
before the maximum can be computed.
In comparison, if the data were tidy,
all we would have to do is compute the maximum value for the commuter column.
To reshape this untidy data set to a tidy (and in this case, wider) format,
we need to create columns called “population”, “commuters”, and “incorporated.”
This is illustrated in the right table of <a class="reference internal" href="#fig-long-to-wide"><span class="std std-numref">Fig. 19</span></a>.</p>
<div class="caption-hack figure align-default" id="fig-long-to-wide">
<img alt="_images/pivot_functions.002.jpeg" src="_images/pivot_functions.002.jpeg" />
<p class="caption"><span class="caption-number">Fig. 19 </span><span class="caption-text">Going from long to wide data.</span><a class="headerlink" href="#fig-long-to-wide" title="Permalink to this image">¶</a></p>
</div>
<p>To tidy this type of data in Python, we can use the <code class="docutils literal notranslate"><span class="pre">.pivot</span></code> function.
The <code class="docutils literal notranslate"><span class="pre">.pivot</span></code> function generally increases the number of columns (widens)
and decreases the number of rows in a data set.
To learn how to use <code class="docutils literal notranslate"><span class="pre">.pivot</span></code>,
we will work through an example
with the <code class="docutils literal notranslate"><span class="pre">region_lang_top5_cities_long.csv</span></code> data set.
This data set contains the number of Canadians reporting
the primary language at home and work for five
major cities (Toronto, Montréal, Vancouver, Calgary and Edmonton).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lang_long</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/region_lang_top5_cities_long.csv&quot;</span><span class="p">)</span>
<span class="n">lang_long</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>type</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Montréal</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>most_at_home</td>
      <td>15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Montréal</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>most_at_work</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Toronto</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>most_at_home</td>
      <td>50</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Toronto</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>most_at_work</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Calgary</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>most_at_home</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2135</th>
      <td>Calgary</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>most_at_work</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2136</th>
      <td>Edmonton</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>most_at_home</td>
      <td>280</td>
    </tr>
    <tr>
      <th>2137</th>
      <td>Edmonton</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>most_at_work</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2138</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>most_at_home</td>
      <td>40</td>
    </tr>
    <tr>
      <th>2139</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>most_at_work</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2140 rows × 5 columns</p>
</div></div></div>
</div>
<p>What makes the data set shown above untidy?
In this example, each observation is a language in a region.
However, each observation is split across multiple rows:
one where the count for <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> is recorded,
and the other where the count for <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code> is recorded.
Suppose the goal with this data was to
visualize the relationship between the number of
Canadians reporting their primary language at home and work.
Doing that would be difficult with this data in its current form,
since these two variables are stored in the same column.
<a class="reference internal" href="#fig-img-pivot-wider-table"><span class="std std-numref">Fig. 20</span></a> shows how this data
will be tidied using the <code class="docutils literal notranslate"><span class="pre">.pivot</span></code> function.</p>
<div class="caption-hack figure align-default" id="fig-img-pivot-wider-table">
<img alt="_images/pandas_pivot_long-wide.png" src="_images/pandas_pivot_long-wide.png" />
<p class="caption"><span class="caption-number">Fig. 20 </span><span class="caption-text">Going from long to wide with the <code class="docutils literal notranslate"><span class="pre">.pivot</span></code> function.</span><a class="headerlink" href="#fig-img-pivot-wider-table" title="Permalink to this image">¶</a></p>
</div>
<p><a class="reference internal" href="#fig-img-pivot-wider"><span class="std std-numref">Fig. 21</span></a> details the arguments that we need to specify
in the <code class="docutils literal notranslate"><span class="pre">.pivot</span></code> function.</p>
<div class="caption-hack figure align-default" id="fig-img-pivot-wider">
<img alt="_images/pandas_pivot_args_labels.png" src="_images/pandas_pivot_args_labels.png" />
<p class="caption"><span class="caption-number">Fig. 21 </span><span class="caption-text">Syntax for the <code class="docutils literal notranslate"><span class="pre">.pivot</span></code> function.</span><a class="headerlink" href="#fig-img-pivot-wider" title="Permalink to this image">¶</a></p>
</div>
<p>We will apply the function as detailed in <a class="reference internal" href="#fig-img-pivot-wider"><span class="std std-numref">Fig. 21</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lang_home_tidy</span> <span class="o">=</span> <span class="n">lang_long</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span>
    <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;language&quot;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">],</span> <span class="n">values</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">lang_home_tidy</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;region&quot;</span><span class="p">,</span>
    <span class="s2">&quot;category&quot;</span><span class="p">,</span>
    <span class="s2">&quot;language&quot;</span><span class="p">,</span>
    <span class="s2">&quot;most_at_home&quot;</span><span class="p">,</span>
    <span class="s2">&quot;most_at_work&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">lang_home_tidy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Calgary</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Calgary</td>
      <td>Aboriginal languages</td>
      <td>Algonquian languages, n.i.e.</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Calgary</td>
      <td>Aboriginal languages</td>
      <td>Algonquin</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Calgary</td>
      <td>Aboriginal languages</td>
      <td>Athabaskan languages, n.i.e.</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Calgary</td>
      <td>Aboriginal languages</td>
      <td>Atikamekw</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
      <td>2495</td>
      <td>45</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
      <td>10</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>40</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Vancouver</td>
      <td>Official languages</td>
      <td>English</td>
      <td>1622735</td>
      <td>1330555</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Vancouver</td>
      <td>Official languages</td>
      <td>French</td>
      <td>8630</td>
      <td>3245</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lang_home_tidy</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region          object
category        object
language        object
most_at_home     int64
most_at_work     int64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>The data above is now tidy! We can go through the three criteria again to check
that this data is a tidy data set.</p>
<ol class="simple">
<li><p>All the statistical variables are their own columns in the data frame (i.e.,
<code class="docutils literal notranslate"><span class="pre">most_at_home</span></code>, and <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code> have been separated into their own
columns in the data frame).</p></li>
<li><p>Each observation, (i.e., each language in a region) is in a single row.</p></li>
<li><p>Each value is a single cell (i.e., its row, column position in the data
frame is not shared with another value).</p></li>
</ol>
<p>You might notice that we have the same number of columns in the tidy data set as
we did in the messy one. Therefore <code class="docutils literal notranslate"><span class="pre">.pivot</span></code> didn’t really “widen” the data.
This is just because the original <code class="docutils literal notranslate"><span class="pre">type</span></code> column only had
two categories in it. If it had more than two, <code class="docutils literal notranslate"><span class="pre">.pivot</span></code> would have created
more columns, and we would see the data set “widen.”</p>
</div>
<div class="section" id="tidying-up-using-str-split-to-deal-with-multiple-delimiters">
<span id="str-split"></span><h3>Tidying up: using <code class="docutils literal notranslate"><span class="pre">.str.split</span></code> to deal with multiple delimiters<a class="headerlink" href="#tidying-up-using-str-split-to-deal-with-multiple-delimiters" title="Permalink to this headline">¶</a></h3>
<p>Data are also not considered tidy when multiple values are stored in the same \index{separate}
cell. The data set we show below is even messier than the ones we dealt with
above: the <code class="docutils literal notranslate"><span class="pre">Toronto</span></code>, <code class="docutils literal notranslate"><span class="pre">Montréal</span></code>, <code class="docutils literal notranslate"><span class="pre">Vancouver</span></code>, <code class="docutils literal notranslate"><span class="pre">Calgary</span></code> and <code class="docutils literal notranslate"><span class="pre">Edmonton</span></code> columns
contain the number of Canadians reporting their primary language at home and
work in one column separated by the delimiter (<code class="docutils literal notranslate"><span class="pre">/</span></code>). The column names are the \index{delimiter}
values of a variable, <em>and</em> each value does not have its own cell! To turn this
messy data into tidy data, we’ll have to fix these issues.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lang_messy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/region_lang_top5_cities_messy.csv&quot;</span><span class="p">)</span>
<span class="n">lang_messy</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>Toronto</th>
      <th>Montréal</th>
      <th>Vancouver</th>
      <th>Calgary</th>
      <th>Edmonton</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>50/0</td>
      <td>15/0</td>
      <td>15/0</td>
      <td>5/0</td>
      <td>10/0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afrikaans</td>
      <td>265/0</td>
      <td>10/0</td>
      <td>520/10</td>
      <td>505/15</td>
      <td>300/0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>185/10</td>
      <td>65/0</td>
      <td>10/0</td>
      <td>15/0</td>
      <td>20/0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Akan (Twi)</td>
      <td>4045/20</td>
      <td>440/0</td>
      <td>125/10</td>
      <td>330/0</td>
      <td>445/0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Albanian</td>
      <td>6380/215</td>
      <td>1445/20</td>
      <td>530/10</td>
      <td>620/25</td>
      <td>370/10</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>209</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wolof</td>
      <td>75/0</td>
      <td>770/0</td>
      <td>5/0</td>
      <td>65/0</td>
      <td>90/10</td>
    </tr>
    <tr>
      <th>210</th>
      <td>Aboriginal languages</td>
      <td>Woods Cree</td>
      <td>0/10</td>
      <td>0/0</td>
      <td>5/0</td>
      <td>0/0</td>
      <td>20/0</td>
    </tr>
    <tr>
      <th>211</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
      <td>3130/30</td>
      <td>760/15</td>
      <td>2495/45</td>
      <td>210/0</td>
      <td>120/0</td>
    </tr>
    <tr>
      <th>212</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
      <td>350/20</td>
      <td>6665/860</td>
      <td>10/0</td>
      <td>10/0</td>
      <td>0/0</td>
    </tr>
    <tr>
      <th>213</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>1080/10</td>
      <td>45/0</td>
      <td>40/0</td>
      <td>350/0</td>
      <td>280/0</td>
    </tr>
  </tbody>
</table>
<p>214 rows × 7 columns</p>
</div></div></div>
</div>
<p>First we’ll use <code class="docutils literal notranslate"><span class="pre">.melt</span></code> to create two columns, <code class="docutils literal notranslate"><span class="pre">region</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code>,
similar to what we did previously.
The new <code class="docutils literal notranslate"><span class="pre">region</span></code> columns will contain the region names,
and the new column <code class="docutils literal notranslate"><span class="pre">value</span></code> will be a temporary holding place for the
data that we need to further separate, i.e., the
number of Canadians reporting their primary language at home and work.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lang_messy_longer</span> <span class="o">=</span> <span class="n">lang_messy</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
    <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;language&quot;</span><span class="p">],</span>
    <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Toronto&quot;</span><span class="p">,</span> <span class="s2">&quot;Montréal&quot;</span><span class="p">,</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">,</span> <span class="s2">&quot;Calgary&quot;</span><span class="p">,</span> <span class="s2">&quot;Edmonton&quot;</span><span class="p">],</span>
    <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
    <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">lang_messy_longer</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>50/0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>265/0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>185/10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>4045/20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>6380/215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wolof</td>
      <td>Edmonton</td>
      <td>90/10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Aboriginal languages</td>
      <td>Woods Cree</td>
      <td>Edmonton</td>
      <td>20/0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
      <td>Edmonton</td>
      <td>120/0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
      <td>Edmonton</td>
      <td>0/0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>Edmonton</td>
      <td>280/0</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 4 columns</p>
</div></div></div>
</div>
<p>Next we’ll use <code class="docutils literal notranslate"><span class="pre">.str.split</span></code> to split the <code class="docutils literal notranslate"><span class="pre">value</span></code> column into two columns.
One column will contain only the counts of Canadians
that speak each language most at home,
and the other will contain the counts of Canadians
that speak each language most at work for each region.
<a class="reference internal" href="#fig-img-separate"><span class="std std-numref">Fig. 22</span></a>
outlines what we need to specify to use <code class="docutils literal notranslate"><span class="pre">.str.split</span></code>.</p>
<div class="caption-hack figure align-default" id="fig-img-separate">
<img alt="_images/str-split_args_labels.png" src="_images/str-split_args_labels.png" />
<p class="caption"><span class="caption-number">Fig. 22 </span><span class="caption-text">Syntax for the <code class="docutils literal notranslate"><span class="pre">.str.split</span></code> function.</span><a class="headerlink" href="#fig-img-separate" title="Permalink to this image">¶</a></p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
        <span class="p">(</span><span class="n">lang_messy_longer</span><span class="p">,</span> <span class="n">lang_messy_longer</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;most_at_home&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;most_at_work&quot;</span><span class="p">})</span>
    <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
<span class="p">)</span>

<span class="n">tidy_lang</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wolof</td>
      <td>Edmonton</td>
      <td>90</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Aboriginal languages</td>
      <td>Woods Cree</td>
      <td>Edmonton</td>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
      <td>Edmonton</td>
      <td>120</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
      <td>Edmonton</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>Edmonton</td>
      <td>280</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>category        object
language        object
region          object
most_at_home    object
most_at_work    object
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Is this data set now tidy? If we recall the three criteria for tidy data:</p>
<ul class="simple">
<li><p>each row is a single observation,</p></li>
<li><p>each column is a single variable, and</p></li>
<li><p>each value is a single cell.</p></li>
</ul>
<p>We can see that this data now satisfies all three criteria, making it easier to
analyze. But we aren’t done yet! Notice in the table, all of the variables are
“object” data types. Object data types are columns of strings or columns with mixed types. In the previous example in Section <a class="reference internal" href="#pivot-wider"><span class="std std-ref">Tidying up: going from long to wide using .pivot</span></a>, the
<code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> and <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code> variables were <code class="docutils literal notranslate"><span class="pre">int64</span></code> (integer)—you can
verify this by calling <code class="docutils literal notranslate"><span class="pre">df.dtypes</span></code>—which is a type
of numeric data. This change is due to the delimiter (<code class="docutils literal notranslate"><span class="pre">/</span></code>) when we read in this
messy data set. Python read these columns in as string types, and by default,
<code class="docutils literal notranslate"><span class="pre">.str.split</span></code> will return columns as object data types.</p>
<p>It makes sense for <code class="docutils literal notranslate"><span class="pre">region</span></code>, <code class="docutils literal notranslate"><span class="pre">category</span></code>, and <code class="docutils literal notranslate"><span class="pre">language</span></code> to be stored as a
object type. However, suppose we want to apply any functions that treat the
<code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> and <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code> columns as a number (e.g., finding rows
above a numeric threshold of a column).
In that case,
it won’t be possible to do if the variable is stored as a <code class="docutils literal notranslate"><span class="pre">object</span></code>.
Fortunately, the <code class="docutils literal notranslate"><span class="pre">pandas.to_numeric</span></code> function provides a natural way to fix problems
like this: it will convert the columns to the best numeric data types.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">])</span>
<span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;most_at_work&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;most_at_work&quot;</span><span class="p">])</span>
<span class="n">tidy_lang</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wolof</td>
      <td>Edmonton</td>
      <td>90</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Aboriginal languages</td>
      <td>Woods Cree</td>
      <td>Edmonton</td>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
      <td>Edmonton</td>
      <td>120</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
      <td>Edmonton</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>Edmonton</td>
      <td>280</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>category        object
language        object
region          object
most_at_home     int64
most_at_work     int64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Now we see <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> and <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code> columns are of <code class="docutils literal notranslate"><span class="pre">int64</span></code> data types,
indicating they are integer data types (i.e., numbers)!</p>
</div>
</div>
<div class="section" id="using-loc-and-iloc-to-extract-a-range-of-columns">
<span id="loc-iloc"></span><h2>Using <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> and <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code> to extract a range of columns<a class="headerlink" href="#using-loc-and-iloc-to-extract-a-range-of-columns" title="Permalink to this headline">¶</a></h2>
<p>Now that the <code class="docutils literal notranslate"><span class="pre">tidy_lang</span></code> data is indeed <em>tidy</em>, we can start manipulating it \index{select!helpers}
using the powerful suite of functions from the <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.
For the first example, recall <code class="docutils literal notranslate"><span class="pre">.loc[]</span></code> from Chapter <span class="xref std std-ref">intro</span>,
which lets us create a subset of columns from a data frame.
Suppose we wanted to select only the columns <code class="docutils literal notranslate"><span class="pre">language</span></code>, <code class="docutils literal notranslate"><span class="pre">region</span></code>,
<code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> and <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code> from the <code class="docutils literal notranslate"><span class="pre">tidy_lang</span></code> data set. Using what we
learned in Chapter <span class="xref std std-ref">intro</span>, we would pass all of these column names into the square brackets:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_columns</span> <span class="o">=</span> <span class="n">tidy_lang</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;language&quot;</span><span class="p">,</span> <span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;most_at_home&quot;</span><span class="p">,</span> <span class="s2">&quot;most_at_work&quot;</span><span class="p">]]</span>
<span class="n">selected_columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Wolof</td>
      <td>Edmonton</td>
      <td>90</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Woods Cree</td>
      <td>Edmonton</td>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Wu (Shanghainese)</td>
      <td>Edmonton</td>
      <td>120</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Yiddish</td>
      <td>Edmonton</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Yoruba</td>
      <td>Edmonton</td>
      <td>280</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 4 columns</p>
</div></div></div>
</div>
<p>Here we wrote out the names of each of the columns. However, this method is
time-consuming, especially if you have a lot of columns! Another approach is to
index with integers. <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code> make it easier for
us to select columns. For instance, we can use <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code> to choose a
range of columns rather than typing each column name out. To do this, we use the
colon (<code class="docutils literal notranslate"><span class="pre">:</span></code>) operator to denote the range. For example, to get all the columns in \index{column range}
the <code class="docutils literal notranslate"><span class="pre">tidy_lang</span></code> data frame from <code class="docutils literal notranslate"><span class="pre">language</span></code> to <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code>, we pass <code class="docutils literal notranslate"><span class="pre">:</span></code> before the comma indicating we want to retrieve all rows, and <code class="docutils literal notranslate"><span class="pre">1:</span></code> after the comma indicating we want only columns from index 1 (<em>i.e.</em> <code class="docutils literal notranslate"><span class="pre">language</span></code>) and afterwords.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">column_range</span> <span class="o">=</span> <span class="n">tidy_lang</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
<span class="n">column_range</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Wolof</td>
      <td>Edmonton</td>
      <td>90</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Woods Cree</td>
      <td>Edmonton</td>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Wu (Shanghainese)</td>
      <td>Edmonton</td>
      <td>120</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Yiddish</td>
      <td>Edmonton</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Yoruba</td>
      <td>Edmonton</td>
      <td>280</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 4 columns</p>
</div></div></div>
</div>
<p>Notice that we get the same output as we did above,
but with less (and clearer!) code. This type of operator
is especially handy for large data sets.</p>
<p>Suppose instead we wanted to extract columns that followed a particular pattern
rather than just selecting a range. For example, let’s say we wanted only to select the
columns <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> and <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code>. There are other functions that allow
us to select variables based on their names. In particular, we can use the <code class="docutils literal notranslate"><span class="pre">.str.startswith</span></code> method \index{select!starts_with}
to choose only the columns that start with the word “most”:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">tidy_lang</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;most&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>90</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>120</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>280</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 2 columns</p>
</div></div></div>
</div>
<p>We could also have chosen the columns containing an underscore <code class="docutils literal notranslate"><span class="pre">_</span></code> by using the
<code class="docutils literal notranslate"><span class="pre">.str.contains(&quot;_&quot;)</span></code>, since we notice
the columns we want contain underscores and the others don’t. \index{select!contains}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">tidy_lang</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>90</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>120</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>280</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 2 columns</p>
</div></div></div>
</div>
<p>There are many different functions that help with selecting
variables based on certain criteria.
The additional resources section at the end of this chapter
provides a comprehensive resource on these functions.</p>
</div>
<div class="section" id="using-df-to-extract-rows">
<h2>Using <code class="docutils literal notranslate"><span class="pre">df[]</span></code> to extract rows<a class="headerlink" href="#using-df-to-extract-rows" title="Permalink to this headline">¶</a></h2>
<p>Next, we revisit the <code class="docutils literal notranslate"><span class="pre">df[]</span></code> from Chapter <span class="xref std std-ref">intro</span>,
which lets us create a subset of rows from a data frame.
Recall the argument to the <code class="docutils literal notranslate"><span class="pre">df[]</span></code>:
column names or a logical statement evaluated to either <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>;
<code class="docutils literal notranslate"><span class="pre">df[]</span></code> works by returning the rows  where the logical statement evaluates to <code class="docutils literal notranslate"><span class="pre">True</span></code>.
This section will highlight more advanced usage of the <code class="docutils literal notranslate"><span class="pre">df[]</span></code> function.
In particular, this section provides an in-depth treatment of the variety of logical statements
one can use in the <code class="docutils literal notranslate"><span class="pre">df[]</span></code> to select subsets of rows.</p>
<div class="section" id="extracting-rows-that-have-a-certain-value-with">
<h3>Extracting rows that have a certain value with <code class="docutils literal notranslate"><span class="pre">==</span></code><a class="headerlink" href="#extracting-rows-that-have-a-certain-value-with" title="Permalink to this headline">¶</a></h3>
<p>Suppose we are only interested in the subset of rows in <code class="docutils literal notranslate"><span class="pre">tidy_lang</span></code> corresponding to the
official languages of Canada (English and French).
We can extract these rows by using the <em>equivalency operator</em> (<code class="docutils literal notranslate"><span class="pre">==</span></code>)
to compare the values of the <code class="docutils literal notranslate"><span class="pre">category</span></code> column
with the value <code class="docutils literal notranslate"><span class="pre">&quot;Official</span> <span class="pre">languages&quot;</span></code>.
With these arguments, <code class="docutils literal notranslate"><span class="pre">df[]</span></code> returns a data frame with all the columns
of the input data frame
but only the rows we asked for in the logical statement, i.e.,
those where the <code class="docutils literal notranslate"><span class="pre">category</span></code> column holds the value <code class="docutils literal notranslate"><span class="pre">&quot;Official</span> <span class="pre">languages&quot;</span></code>.
We name this data frame <code class="docutils literal notranslate"><span class="pre">official_langs</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">official_langs</span> <span class="o">=</span> <span class="n">tidy_lang</span><span class="p">[</span><span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Official languages&quot;</span><span class="p">]</span>
<span class="n">official_langs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>54</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Toronto</td>
      <td>3836770</td>
      <td>3218725</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Toronto</td>
      <td>29800</td>
      <td>11940</td>
    </tr>
    <tr>
      <th>268</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Montréal</td>
      <td>620510</td>
      <td>412120</td>
    </tr>
    <tr>
      <th>273</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Montréal</td>
      <td>2669195</td>
      <td>1607550</td>
    </tr>
    <tr>
      <th>482</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Vancouver</td>
      <td>1622735</td>
      <td>1330555</td>
    </tr>
    <tr>
      <th>487</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Vancouver</td>
      <td>8630</td>
      <td>3245</td>
    </tr>
    <tr>
      <th>696</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Calgary</td>
      <td>1065070</td>
      <td>844740</td>
    </tr>
    <tr>
      <th>701</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Calgary</td>
      <td>8630</td>
      <td>2140</td>
    </tr>
    <tr>
      <th>910</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Edmonton</td>
      <td>1050410</td>
      <td>792700</td>
    </tr>
    <tr>
      <th>915</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Edmonton</td>
      <td>10950</td>
      <td>2520</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="extracting-rows-that-do-not-have-a-certain-value-with">
<h3>Extracting rows that do not have a certain value with <code class="docutils literal notranslate"><span class="pre">!=</span></code><a class="headerlink" href="#extracting-rows-that-do-not-have-a-certain-value-with" title="Permalink to this headline">¶</a></h3>
<p>What if we want all the other language categories in the data set <em>except</em> for
those in the <code class="docutils literal notranslate"><span class="pre">&quot;Official</span> <span class="pre">languages&quot;</span></code> category? We can accomplish this with the <code class="docutils literal notranslate"><span class="pre">!=</span></code>
operator, which means “not equal to”. So if we want to find all the rows
where the <code class="docutils literal notranslate"><span class="pre">category</span></code> does <em>not</em> equal <code class="docutils literal notranslate"><span class="pre">&quot;Official</span> <span class="pre">languages&quot;</span></code> we write the code
below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="p">[</span><span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;Official languages&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wolof</td>
      <td>Edmonton</td>
      <td>90</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Aboriginal languages</td>
      <td>Woods Cree</td>
      <td>Edmonton</td>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
      <td>Edmonton</td>
      <td>120</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
      <td>Edmonton</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>Edmonton</td>
      <td>280</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1060 rows × 5 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="extracting-rows-satisfying-multiple-conditions-using">
<span id="filter-and"></span><h3>Extracting rows satisfying multiple conditions using <code class="docutils literal notranslate"><span class="pre">&amp;</span></code><a class="headerlink" href="#extracting-rows-satisfying-multiple-conditions-using" title="Permalink to this headline">¶</a></h3>
<p>Suppose now we want to look at only the rows
for the French language in Montréal.
To do this, we need to filter the data set
to find rows that satisfy multiple conditions simultaneously.
We can do this with the ampersand symbol (<code class="docutils literal notranslate"><span class="pre">&amp;</span></code>), which
is interpreted by Python as “and”.
We write the code as shown below to filter the <code class="docutils literal notranslate"><span class="pre">official_langs</span></code> data frame
to subset the rows where <code class="docutils literal notranslate"><span class="pre">region</span> <span class="pre">==</span> <span class="pre">&quot;Montréal&quot;</span></code>
<em>and</em> the <code class="docutils literal notranslate"><span class="pre">language</span> <span class="pre">==</span> <span class="pre">&quot;French&quot;</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span><span class="p">[(</span><span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Montréal&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;language&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;French&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>273</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Montréal</td>
      <td>2669195</td>
      <td>1607550</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="extracting-rows-satisfying-at-least-one-condition-using">
<h3>Extracting rows satisfying at least one condition using <code class="docutils literal notranslate"><span class="pre">|</span></code><a class="headerlink" href="#extracting-rows-satisfying-at-least-one-condition-using" title="Permalink to this headline">¶</a></h3>
<p>Suppose we were interested in only those rows corresponding to cities in Alberta
in the <code class="docutils literal notranslate"><span class="pre">official_langs</span></code> data set (Edmonton and Calgary).
We can’t use <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> as we did above because <code class="docutils literal notranslate"><span class="pre">region</span></code>
cannot be both Edmonton <em>and</em> Calgary simultaneously.
Instead, we can use the vertical pipe (<code class="docutils literal notranslate"><span class="pre">|</span></code>) logical operator,
which gives us the cases where one condition <em>or</em>
another condition <em>or</em> both are satisfied.
In the code below, we ask Python to return the rows
where the <code class="docutils literal notranslate"><span class="pre">region</span></code> columns are equal to “Calgary” <em>or</em> “Edmonton”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">official_langs</span><span class="p">[</span>
    <span class="p">(</span><span class="n">official_langs</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Calgary&quot;</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">official_langs</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Edmonton&quot;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>696</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Calgary</td>
      <td>1065070</td>
      <td>844740</td>
    </tr>
    <tr>
      <th>701</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Calgary</td>
      <td>8630</td>
      <td>2140</td>
    </tr>
    <tr>
      <th>910</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Edmonton</td>
      <td>1050410</td>
      <td>792700</td>
    </tr>
    <tr>
      <th>915</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Edmonton</td>
      <td>10950</td>
      <td>2520</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="extracting-rows-with-values-in-a-list-using-isin">
<h3>Extracting rows with values in a list using <code class="docutils literal notranslate"><span class="pre">.isin()</span></code><a class="headerlink" href="#extracting-rows-with-values-in-a-list-using-isin" title="Permalink to this headline">¶</a></h3>
<p>Next, suppose we want to see the populations of our five cities.
Let’s read in the <code class="docutils literal notranslate"><span class="pre">region_data.csv</span></code> file
that comes from the 2016 Canadian census,
as it contains statistics for number of households, land area, population
and number of dwellings for different regions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/region_data.csv&quot;</span><span class="p">)</span>
<span class="n">region_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>households</th>
      <th>area</th>
      <th>population</th>
      <th>dwellings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Belleville</td>
      <td>43002</td>
      <td>1354.65121</td>
      <td>103472</td>
      <td>45050</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Lethbridge</td>
      <td>45696</td>
      <td>3046.69699</td>
      <td>117394</td>
      <td>48317</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Thunder Bay</td>
      <td>52545</td>
      <td>2618.26318</td>
      <td>121621</td>
      <td>57146</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Peterborough</td>
      <td>50533</td>
      <td>1636.98336</td>
      <td>121721</td>
      <td>55662</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Saint John</td>
      <td>52872</td>
      <td>3793.42158</td>
      <td>126202</td>
      <td>58398</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Ottawa - Gatineau</td>
      <td>535499</td>
      <td>7168.96442</td>
      <td>1323783</td>
      <td>571146</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Calgary</td>
      <td>519693</td>
      <td>5241.70103</td>
      <td>1392609</td>
      <td>544870</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Vancouver</td>
      <td>960894</td>
      <td>3040.41532</td>
      <td>2463431</td>
      <td>1027613</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Montréal</td>
      <td>1727310</td>
      <td>4638.24059</td>
      <td>4098927</td>
      <td>1823281</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Toronto</td>
      <td>2135909</td>
      <td>6269.93132</td>
      <td>5928040</td>
      <td>2235145</td>
    </tr>
  </tbody>
</table>
<p>35 rows × 5 columns</p>
</div></div></div>
</div>
<p>To get the population of the five cities
we can filter the data set using the <code class="docutils literal notranslate"><span class="pre">.isin</span></code> method.
The <code class="docutils literal notranslate"><span class="pre">.isin</span></code> method is used to see if an element belongs to a list.
Here we are filtering for rows where the value in the <code class="docutils literal notranslate"><span class="pre">region</span></code> column
matches any of the five cities we are intersted in: Toronto, Montréal,
Vancouver, Calgary, and Edmonton.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">city_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Toronto&quot;</span><span class="p">,</span> <span class="s2">&quot;Montréal&quot;</span><span class="p">,</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">,</span> <span class="s2">&quot;Calgary&quot;</span><span class="p">,</span> <span class="s2">&quot;Edmonton&quot;</span><span class="p">]</span>
<span class="n">five_cities</span> <span class="o">=</span> <span class="n">region_data</span><span class="p">[</span><span class="n">region_data</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">city_names</span><span class="p">)]</span>
<span class="n">five_cities</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>households</th>
      <th>area</th>
      <th>population</th>
      <th>dwellings</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>29</th>
      <td>Edmonton</td>
      <td>502143</td>
      <td>9857.77908</td>
      <td>1321426</td>
      <td>537634</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Calgary</td>
      <td>519693</td>
      <td>5241.70103</td>
      <td>1392609</td>
      <td>544870</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Vancouver</td>
      <td>960894</td>
      <td>3040.41532</td>
      <td>2463431</td>
      <td>1027613</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Montréal</td>
      <td>1727310</td>
      <td>4638.24059</td>
      <td>4098927</td>
      <td>1823281</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Toronto</td>
      <td>2135909</td>
      <td>6269.93132</td>
      <td>5928040</td>
      <td>2235145</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<blockquote>
<div><p><strong>Note:</strong> What’s the difference between <code class="docutils literal notranslate"><span class="pre">==</span></code> and <code class="docutils literal notranslate"><span class="pre">.isin</span></code>? Suppose we have two
Series, <code class="docutils literal notranslate"><span class="pre">seriesA</span></code> and <code class="docutils literal notranslate"><span class="pre">seriesB</span></code>. If you type <code class="docutils literal notranslate"><span class="pre">seriesA</span> <span class="pre">==</span> <span class="pre">seriesB</span></code> into Python it
will compare the series element by element. Python checks if the first element of
<code class="docutils literal notranslate"><span class="pre">seriesA</span></code> equals the first element of <code class="docutils literal notranslate"><span class="pre">seriesB</span></code>, the second element of
<code class="docutils literal notranslate"><span class="pre">seriesA</span></code> equals the second element of <code class="docutils literal notranslate"><span class="pre">seriesB</span></code>, and so on. On the other hand,
<code class="docutils literal notranslate"><span class="pre">seriesA.isin(seriesB)</span></code> compares the first element of <code class="docutils literal notranslate"><span class="pre">seriesA</span></code> to all the
elements in <code class="docutils literal notranslate"><span class="pre">seriesB</span></code>. Then the second element of <code class="docutils literal notranslate"><span class="pre">seriesA</span></code> is compared
to all the elements in <code class="docutils literal notranslate"><span class="pre">seriesB</span></code>, and so on. Notice the difference between <code class="docutils literal notranslate"><span class="pre">==</span></code> and
<code class="docutils literal notranslate"><span class="pre">.isin</span></code> in the example below.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;Vancouver&quot;</span><span class="p">,</span> <span class="s2">&quot;Toronto&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;Toronto&quot;</span><span class="p">,</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    False
1    False
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;Vancouver&quot;</span><span class="p">,</span> <span class="s2">&quot;Toronto&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;Toronto&quot;</span><span class="p">,</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    True
1    True
dtype: bool
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="extracting-rows-above-or-below-a-threshold-using-and">
<h3>Extracting rows above or below a threshold using <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;</span></code><a class="headerlink" href="#extracting-rows-above-or-below-a-threshold-using-and" title="Permalink to this headline">¶</a></h3>
<p>We saw in Section <a class="reference internal" href="#filter-and"><span class="std std-ref">Extracting rows satisfying multiple conditions using &amp;</span></a> that
<span class="pasted-text">2,669,195</span> people reported
speaking French in Montréal as their primary language at home.
If we are interested in finding the official languages in regions
with higher numbers of people who speak it as their primary language at home
compared to French in Montréal, then we can use <code class="docutils literal notranslate"><span class="pre">df[]</span></code> to obtain rows
where the value of <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> is greater than
<span class="pasted-text">2,669,195</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">official_langs</span><span class="p">[</span><span class="n">official_langs</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2669195</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>54</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Toronto</td>
      <td>3836770</td>
      <td>3218725</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This operation returns a data frame with only one row, indicating that when
considering the official languages,
only English in Toronto is reported by more people
as their primary language at home
than French in Montréal according to the 2016 Canadian census.</p>
</div>
</div>
<div class="section" id="using-assign-to-modify-or-add-columns">
<span id="pandas-assign"></span><h2>Using <code class="docutils literal notranslate"><span class="pre">.assign</span></code> to modify or add columns<a class="headerlink" href="#using-assign-to-modify-or-add-columns" title="Permalink to this headline">¶</a></h2>
<div class="section" id="using-assign-to-modify-columns">
<h3>Using <code class="docutils literal notranslate"><span class="pre">.assign</span></code> to modify columns<a class="headerlink" href="#using-assign-to-modify-columns" title="Permalink to this headline">¶</a></h3>
<p>In Section <a class="reference internal" href="#str-split"><span class="std std-ref">Tidying up: using .str.split to deal with multiple delimiters</span></a>,
when we first read in the <code class="docutils literal notranslate"><span class="pre">&quot;region_lang_top5_cities_messy.csv&quot;</span></code> data,
all of the variables were “object” data types. \index{mutate}
During the tidying process,
we used the <code class="docutils literal notranslate"><span class="pre">pandas.to_numeric</span></code> function
to convert the <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> and <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code> columns
to the desired integer (i.e., numeric class) data types and then used <code class="docutils literal notranslate"><span class="pre">df[]</span></code> to overwrite columns.
But suppose we didn’t use the <code class="docutils literal notranslate"><span class="pre">df[]</span></code>,
and needed to modify the columns some other way.
Below we create such a situation
so that we can demonstrate how to use <code class="docutils literal notranslate"><span class="pre">.assign</span></code>
to change the column types of a data frame.
<code class="docutils literal notranslate"><span class="pre">.assign</span></code> is a useful function to modify or create new data frame columns.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lang_messy</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/region_lang_top5_cities_messy.csv&quot;</span><span class="p">)</span>
<span class="n">lang_messy_longer</span> <span class="o">=</span> <span class="n">lang_messy</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
    <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">,</span> <span class="s2">&quot;language&quot;</span><span class="p">],</span>
    <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Toronto&quot;</span><span class="p">,</span> <span class="s2">&quot;Montréal&quot;</span><span class="p">,</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">,</span> <span class="s2">&quot;Calgary&quot;</span><span class="p">,</span> <span class="s2">&quot;Edmonton&quot;</span><span class="p">],</span>
    <span class="n">var_name</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">,</span>
    <span class="n">value_name</span><span class="o">=</span><span class="s2">&quot;value&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">tidy_lang_obj</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
        <span class="p">(</span><span class="n">lang_messy_longer</span><span class="p">,</span> <span class="n">lang_messy_longer</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)),</span>
        <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;most_at_home&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;most_at_work&quot;</span><span class="p">})</span>
    <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>
<span class="p">)</span>
<span class="n">official_langs_obj</span> <span class="o">=</span> <span class="n">tidy_lang_obj</span><span class="p">[</span><span class="n">tidy_lang_obj</span><span class="p">[</span><span class="s2">&quot;category&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Official languages&quot;</span><span class="p">]</span>

<span class="n">official_langs_obj</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>54</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Toronto</td>
      <td>3836770</td>
      <td>3218725</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Toronto</td>
      <td>29800</td>
      <td>11940</td>
    </tr>
    <tr>
      <th>268</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Montréal</td>
      <td>620510</td>
      <td>412120</td>
    </tr>
    <tr>
      <th>273</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Montréal</td>
      <td>2669195</td>
      <td>1607550</td>
    </tr>
    <tr>
      <th>482</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Vancouver</td>
      <td>1622735</td>
      <td>1330555</td>
    </tr>
    <tr>
      <th>487</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Vancouver</td>
      <td>8630</td>
      <td>3245</td>
    </tr>
    <tr>
      <th>696</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Calgary</td>
      <td>1065070</td>
      <td>844740</td>
    </tr>
    <tr>
      <th>701</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Calgary</td>
      <td>8630</td>
      <td>2140</td>
    </tr>
    <tr>
      <th>910</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Edmonton</td>
      <td>1050410</td>
      <td>792700</td>
    </tr>
    <tr>
      <th>915</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Edmonton</td>
      <td>10950</td>
      <td>2520</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">official_langs_obj</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>category        object
language        object
region          object
most_at_home    object
most_at_work    object
dtype: object
</pre></div>
</div>
</div>
</div>
<p>To use the <code class="docutils literal notranslate"><span class="pre">.assign</span></code> method, again we first specify the object to be the data set,
and in the following arguments,
we specify the name of the column we want to modify or create
(here <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> and <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code>), an <code class="docutils literal notranslate"><span class="pre">=</span></code> sign,
and then the function we want to apply (here <code class="docutils literal notranslate"><span class="pre">pandas.to_numeric</span></code>).
In the function we want to apply,
we refer to the column upon which we want it to act
(here <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> and <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code>).
In our example, we are naming the columns the same
names as columns that already exist in the data frame
(“most_at_home”, “most_at_work”)
and this will cause <code class="docutils literal notranslate"><span class="pre">.assign</span></code> to <em>overwrite</em> those columns
(also referred to as modifying those columns <em>in-place</em>).
If we were to give the columns a new name,
then <code class="docutils literal notranslate"><span class="pre">.assign</span></code> would create new columns with the names we specified.
<code class="docutils literal notranslate"><span class="pre">.assign</span></code>’s general syntax is detailed in <a class="reference internal" href="#fig-img-assign"><span class="std std-numref">Fig. 23</span></a>.</p>
<div class="caption-hack figure align-default" id="fig-img-assign">
<img alt="_images/pandas_assign_args_labels.png" src="_images/pandas_assign_args_labels.png" />
<p class="caption"><span class="caption-number">Fig. 23 </span><span class="caption-text">Syntax for the <code class="docutils literal notranslate"><span class="pre">.assign</span></code> function.</span><a class="headerlink" href="#fig-img-assign" title="Permalink to this image">¶</a></p>
</div>
<p>Below we use <code class="docutils literal notranslate"><span class="pre">.assign</span></code> to convert the columns <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> and <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code>
to numeric data types in the <code class="docutils literal notranslate"><span class="pre">official_langs</span></code> data set as described in
<a class="reference internal" href="#fig-img-assign"><span class="std std-numref">Fig. 23</span></a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">official_langs_numeric</span> <span class="o">=</span> <span class="n">official_langs_obj</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">most_at_home</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">official_langs_obj</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]),</span>
    <span class="n">most_at_work</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">official_langs_obj</span><span class="p">[</span><span class="s2">&quot;most_at_work&quot;</span><span class="p">]),</span>
<span class="p">)</span>

<span class="n">official_langs_numeric</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>54</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Toronto</td>
      <td>3836770</td>
      <td>3218725</td>
    </tr>
    <tr>
      <th>59</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Toronto</td>
      <td>29800</td>
      <td>11940</td>
    </tr>
    <tr>
      <th>268</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Montréal</td>
      <td>620510</td>
      <td>412120</td>
    </tr>
    <tr>
      <th>273</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Montréal</td>
      <td>2669195</td>
      <td>1607550</td>
    </tr>
    <tr>
      <th>482</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Vancouver</td>
      <td>1622735</td>
      <td>1330555</td>
    </tr>
    <tr>
      <th>487</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Vancouver</td>
      <td>8630</td>
      <td>3245</td>
    </tr>
    <tr>
      <th>696</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Calgary</td>
      <td>1065070</td>
      <td>844740</td>
    </tr>
    <tr>
      <th>701</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Calgary</td>
      <td>8630</td>
      <td>2140</td>
    </tr>
    <tr>
      <th>910</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Edmonton</td>
      <td>1050410</td>
      <td>792700</td>
    </tr>
    <tr>
      <th>915</th>
      <td>Official languages</td>
      <td>French</td>
      <td>Edmonton</td>
      <td>10950</td>
      <td>2520</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">official_langs_numeric</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>category        object
language        object
region          object
most_at_home     int64
most_at_work     int64
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Now we see that the <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> and <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code> columns are both <code class="docutils literal notranslate"><span class="pre">int64</span></code> (which is a numeric data type)!</p>
</div>
<div class="section" id="using-assign-to-create-new-columns">
<h3>Using <code class="docutils literal notranslate"><span class="pre">.assign</span></code> to create new columns<a class="headerlink" href="#using-assign-to-create-new-columns" title="Permalink to this headline">¶</a></h3>
<p>We can see in the table that
<span class="pasted-text">3,836,770</span> people reported
speaking English in Toronto as their primary language at home, according to
the 2016 Canadian census. What does this number mean to us? To understand this
number, we need context. In particular, how many people were in Toronto when
this data was collected? From the 2016 Canadian census profile, the population
of Toronto was reported to be
<span class="pasted-text">5,928,040</span> people.
The number of people who report that English is their primary language at home
is much more meaningful when we report it in this context.
We can even go a step further and transform this count to a relative frequency
or proportion.
We can do this by dividing the number of people reporting a given language
as their primary language at home by the number of people who live in Toronto.
For example,
the proportion of people who reported that their primary language at home
was English in the 2016 Canadian census was <span class="pasted-text">0.65</span>
in Toronto.</p>
<p>Let’s use <code class="docutils literal notranslate"><span class="pre">.assign</span></code> to create a new column in our data frame
that holds the proportion of people who speak English
for our five cities of focus in this chapter.
To accomplish this, we will need to do two tasks
beforehand:</p>
<ol class="simple">
<li><p>Create a list containing the population values for the cities.</p></li>
<li><p>Filter the <code class="docutils literal notranslate"><span class="pre">official_langs</span></code> data frame
so that we only keep the rows where the language is English.</p></li>
</ol>
<p>To create a list containing the population values for the five cities
(Toronto, Montréal, Vancouver, Calgary, Edmonton),
we will use the <code class="docutils literal notranslate"><span class="pre">[]</span></code> (recall that we can also use <code class="docutils literal notranslate"><span class="pre">list()</span></code> to create a list):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">city_pops</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5928040</span><span class="p">,</span> <span class="mi">4098927</span><span class="p">,</span> <span class="mi">2463431</span><span class="p">,</span> <span class="mi">1392609</span><span class="p">,</span> <span class="mi">1321426</span><span class="p">]</span>
<span class="n">city_pops</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[5928040, 4098927, 2463431, 1392609, 1321426]
</pre></div>
</div>
</div>
</div>
<p>And next, we will filter the <code class="docutils literal notranslate"><span class="pre">official_langs</span></code> data frame
so that we only keep the rows where the language is English.
We will name the new data frame we get from this <code class="docutils literal notranslate"><span class="pre">english_langs</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">english_langs</span> <span class="o">=</span> <span class="n">official_langs</span><span class="p">[</span><span class="n">official_langs</span><span class="p">[</span><span class="s2">&quot;language&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;English&quot;</span><span class="p">]</span>
<span class="n">english_langs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>54</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Toronto</td>
      <td>3836770</td>
      <td>3218725</td>
    </tr>
    <tr>
      <th>268</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Montréal</td>
      <td>620510</td>
      <td>412120</td>
    </tr>
    <tr>
      <th>482</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Vancouver</td>
      <td>1622735</td>
      <td>1330555</td>
    </tr>
    <tr>
      <th>696</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Calgary</td>
      <td>1065070</td>
      <td>844740</td>
    </tr>
    <tr>
      <th>910</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Edmonton</td>
      <td>1050410</td>
      <td>792700</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Finally, we can use <code class="docutils literal notranslate"><span class="pre">.assign</span></code> to create a new column,
named <code class="docutils literal notranslate"><span class="pre">most_at_home_proportion</span></code>, that will have value that corresponds to
the proportion of people reporting English as their primary
language at home.
We will compute this by dividing the column by our vector of city populations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">english_langs</span> <span class="o">=</span> <span class="n">english_langs</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">most_at_home_proportion</span><span class="o">=</span><span class="n">english_langs</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">city_pops</span>
<span class="p">)</span>

<span class="n">english_langs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>most_at_home_proportion</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>54</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Toronto</td>
      <td>3836770</td>
      <td>3218725</td>
      <td>0.647224</td>
    </tr>
    <tr>
      <th>268</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Montréal</td>
      <td>620510</td>
      <td>412120</td>
      <td>0.151384</td>
    </tr>
    <tr>
      <th>482</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Vancouver</td>
      <td>1622735</td>
      <td>1330555</td>
      <td>0.658730</td>
    </tr>
    <tr>
      <th>696</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Calgary</td>
      <td>1065070</td>
      <td>844740</td>
      <td>0.764802</td>
    </tr>
    <tr>
      <th>910</th>
      <td>Official languages</td>
      <td>English</td>
      <td>Edmonton</td>
      <td>1050410</td>
      <td>792700</td>
      <td>0.794906</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In the computation above, we had to ensure that we ordered the <code class="docutils literal notranslate"><span class="pre">city_pops</span></code> vector in the
same order as the cities were listed in the <code class="docutils literal notranslate"><span class="pre">english_langs</span></code> data frame.
This is because Python will perform the division computation we did by dividing
each element of the <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> column by each element of the
<code class="docutils literal notranslate"><span class="pre">city_pops</span></code> list, matching them up by position.
Failing to do this would have resulted in the incorrect math being performed.</p>
<blockquote>
<div><p><strong>Note:</strong> In more advanced data wrangling,
one might solve this problem in a less error-prone way though using
a technique called “joins”.
We link to resources that discuss this in the additional
resources at the end of this chapter.</p>
</div></blockquote>
<!--
#### Creating a visualization with tidy data {-}

Now that we have cleaned and wrangled the data, we can make visualizations or do 
statistical analyses to answer questions about it! Let's suppose we want to
answer the question "what proportion of people in each city speak English 
as their primary language at home in these five cities?" Since the data is
cleaned already, in a few short lines of code, we can use `ggplot` to create a
data visualization to answer this question! Here we create a bar plot to represent the proportions for
each region and color the proportions by language.

> Don't worry too much about the code to make this plot for now. We will cover 
> visualizations in detail in Chapter \@ref(viz).

```{r 02-plot, out.width = "100%", fig.cap = "Bar plot of proportions of Canadians reporting English as the most often spoken language at home."}
ggplot(english_langs,
  aes(
    x = region, 
    y = most_at_home_proportion
  )
 ) +
  geom_bar(stat = "identity") +
  xlab("Region") +
  ylab("Proportion of Canadians that speak English most often at home")
```

From this visualization, we can see that in Calgary, Edmonton, Toronto, and
Vancouver, English was reported as the most common primary language used at
home.  However, in Montréal, this does not seem to be the case!
--></div>
</div>
<div class="section" id="combining-functions-by-chaining-the-methods">
<h2>Combining functions by chaining the methods<a class="headerlink" href="#combining-functions-by-chaining-the-methods" title="Permalink to this headline">¶</a></h2>
<p>In Python, we often have to call multiple methods in a sequence to process a data
frame. The basic ways of doing this can become quickly unreadable if there are
many steps. For example, suppose we need to perform three operations on a data
frame called <code class="docutils literal notranslate"><span class="pre">data</span></code>:</p>
<ol class="simple">
<li><p>add a new column <code class="docutils literal notranslate"><span class="pre">new_col</span></code> that is double another <code class="docutils literal notranslate"><span class="pre">old_col</span></code>,</p></li>
<li><p>filter for rows where another column, <code class="docutils literal notranslate"><span class="pre">other_col</span></code>, is more than 5, and</p></li>
<li><p>select only the new column <code class="docutils literal notranslate"><span class="pre">new_col</span></code> for those rows.</p></li>
</ol>
<p>One way of performing these three steps is to just write
multiple lines of code, storing temporary objects as you go:</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">new_col</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;old_col&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">output_2</span> <span class="o">=</span> <span class="n">output_1</span><span class="p">[</span><span class="n">output_1</span><span class="p">[</span><span class="s2">&quot;other_col&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">output_2</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;new_col&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>This is difficult to understand for multiple reasons. The reader may be tricked
into thinking the named <code class="docutils literal notranslate"><span class="pre">output_1</span></code> and <code class="docutils literal notranslate"><span class="pre">output_2</span></code> objects are important for some
reason, while they are just temporary intermediate computations. Further, the
reader has to look through and find where <code class="docutils literal notranslate"><span class="pre">output_1</span></code> and <code class="docutils literal notranslate"><span class="pre">output_2</span></code> are used in
each subsequent line.</p>
<p>Chaining the sequential functions solves this problem, resulting in cleaner and
easier-to-follow code.
The code below accomplishes the same thing as the previous
two code blocks:</p>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">data</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">new_col</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;old_col&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;other_col &gt; 5&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;new_col&quot;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Note:</strong> You might also have noticed that we split the function calls across
lines, similar to when we did this earlier in the chapter
for long function calls. Again, this is allowed and recommended, especially when
the chained function calls create a long line of code. Doing this makes
your code more readable. When you do this, it is important to use parentheses
to tell Python that your code is continuing onto the next line.</p>
</div></blockquote>
<div class="section" id="chaining-df-and-loc">
<h3>Chaining <code class="docutils literal notranslate"><span class="pre">df[]</span></code> and <code class="docutils literal notranslate"><span class="pre">.loc</span></code><a class="headerlink" href="#chaining-df-and-loc" title="Permalink to this headline">¶</a></h3>
<p>Let’s work with the tidy <code class="docutils literal notranslate"><span class="pre">tidy_lang</span></code> data set from Section <a class="reference internal" href="#str-split"><span class="std std-ref">Tidying up: using .str.split to deal with multiple delimiters</span></a>,
which contains the number of Canadians reporting their primary language at home
and work for five major cities
(Toronto, Montréal, Vancouver, Calgary, and Edmonton):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tidy_lang</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Toronto</td>
      <td>50</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afrikaans</td>
      <td>Toronto</td>
      <td>265</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Toronto</td>
      <td>185</td>
      <td>10</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Akan (Twi)</td>
      <td>Toronto</td>
      <td>4045</td>
      <td>20</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Albanian</td>
      <td>Toronto</td>
      <td>6380</td>
      <td>215</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wolof</td>
      <td>Edmonton</td>
      <td>90</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>Aboriginal languages</td>
      <td>Woods Cree</td>
      <td>Edmonton</td>
      <td>20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1067</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
      <td>Edmonton</td>
      <td>120</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1068</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
      <td>Edmonton</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1069</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>Edmonton</td>
      <td>280</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>1070 rows × 5 columns</p>
</div></div></div>
</div>
<p>Suppose we want to create a subset of the data with only the languages and
counts of each language spoken most at home for the city of Vancouver. To do
this, we can use the <code class="docutils literal notranslate"><span class="pre">df[]</span></code> and <code class="docutils literal notranslate"><span class="pre">.loc</span></code>. First, we use <code class="docutils literal notranslate"><span class="pre">df[]</span></code> to
create a data frame called <code class="docutils literal notranslate"><span class="pre">van_data</span></code> that contains only values for Vancouver.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">van_data</span> <span class="o">=</span> <span class="n">tidy_lang</span><span class="p">[</span><span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">]</span>
<span class="n">van_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>category</th>
      <th>language</th>
      <th>region</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>428</th>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>Vancouver</td>
      <td>15</td>
      <td>0</td>
    </tr>
    <tr>
      <th>429</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afrikaans</td>
      <td>Vancouver</td>
      <td>520</td>
      <td>10</td>
    </tr>
    <tr>
      <th>430</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>Vancouver</td>
      <td>10</td>
      <td>0</td>
    </tr>
    <tr>
      <th>431</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Akan (Twi)</td>
      <td>Vancouver</td>
      <td>125</td>
      <td>10</td>
    </tr>
    <tr>
      <th>432</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Albanian</td>
      <td>Vancouver</td>
      <td>530</td>
      <td>10</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>637</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wolof</td>
      <td>Vancouver</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>638</th>
      <td>Aboriginal languages</td>
      <td>Woods Cree</td>
      <td>Vancouver</td>
      <td>5</td>
      <td>0</td>
    </tr>
    <tr>
      <th>639</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Wu (Shanghainese)</td>
      <td>Vancouver</td>
      <td>2495</td>
      <td>45</td>
    </tr>
    <tr>
      <th>640</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yiddish</td>
      <td>Vancouver</td>
      <td>10</td>
      <td>0</td>
    </tr>
    <tr>
      <th>641</th>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>Vancouver</td>
      <td>40</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>214 rows × 5 columns</p>
</div></div></div>
</div>
<p>We then use <code class="docutils literal notranslate"><span class="pre">.loc</span></code> on this data frame to keep only the variables we want:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">van_data_selected</span> <span class="o">=</span> <span class="n">van_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;language&quot;</span><span class="p">,</span> <span class="s2">&quot;most_at_home&quot;</span><span class="p">]]</span>
<span class="n">van_data_selected</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>language</th>
      <th>most_at_home</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>428</th>
      <td>Aboriginal languages, n.o.s.</td>
      <td>15</td>
    </tr>
    <tr>
      <th>429</th>
      <td>Afrikaans</td>
      <td>520</td>
    </tr>
    <tr>
      <th>430</th>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>10</td>
    </tr>
    <tr>
      <th>431</th>
      <td>Akan (Twi)</td>
      <td>125</td>
    </tr>
    <tr>
      <th>432</th>
      <td>Albanian</td>
      <td>530</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>637</th>
      <td>Wolof</td>
      <td>5</td>
    </tr>
    <tr>
      <th>638</th>
      <td>Woods Cree</td>
      <td>5</td>
    </tr>
    <tr>
      <th>639</th>
      <td>Wu (Shanghainese)</td>
      <td>2495</td>
    </tr>
    <tr>
      <th>640</th>
      <td>Yiddish</td>
      <td>10</td>
    </tr>
    <tr>
      <th>641</th>
      <td>Yoruba</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
<p>214 rows × 2 columns</p>
</div></div></div>
</div>
<p>Although this is valid code, there is a more readable approach we could take by
chaining the operations. With chaining, we do not need to create an intermediate
object to store the output from <code class="docutils literal notranslate"><span class="pre">df[]</span></code>. Instead, we can directly call <code class="docutils literal notranslate"><span class="pre">.loc</span></code> upon the
output of <code class="docutils literal notranslate"><span class="pre">df[]</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">van_data_selected</span> <span class="o">=</span> <span class="n">tidy_lang</span><span class="p">[</span><span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Vancouver&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="p">:,</span> <span class="p">[</span><span class="s2">&quot;language&quot;</span><span class="p">,</span> <span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span>
<span class="p">]</span>

<span class="n">van_data_selected</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>language</th>
      <th>most_at_home</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>428</th>
      <td>Aboriginal languages, n.o.s.</td>
      <td>15</td>
    </tr>
    <tr>
      <th>429</th>
      <td>Afrikaans</td>
      <td>520</td>
    </tr>
    <tr>
      <th>430</th>
      <td>Afro-Asiatic languages, n.i.e.</td>
      <td>10</td>
    </tr>
    <tr>
      <th>431</th>
      <td>Akan (Twi)</td>
      <td>125</td>
    </tr>
    <tr>
      <th>432</th>
      <td>Albanian</td>
      <td>530</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>637</th>
      <td>Wolof</td>
      <td>5</td>
    </tr>
    <tr>
      <th>638</th>
      <td>Woods Cree</td>
      <td>5</td>
    </tr>
    <tr>
      <th>639</th>
      <td>Wu (Shanghainese)</td>
      <td>2495</td>
    </tr>
    <tr>
      <th>640</th>
      <td>Yiddish</td>
      <td>10</td>
    </tr>
    <tr>
      <th>641</th>
      <td>Yoruba</td>
      <td>40</td>
    </tr>
  </tbody>
</table>
<p>214 rows × 2 columns</p>
</div></div></div>
</div>
<p>As you can see, both of these approaches—with and without chaining—give us the same output, but the second
approach is clearer and more readable.</p>
</div>
<div class="section" id="chaining-more-than-two-functions">
<h3>Chaining more than two functions<a class="headerlink" href="#chaining-more-than-two-functions" title="Permalink to this headline">¶</a></h3>
<p>Chaining can be used with any method in Python.
Additionally, we can chain together more than two functions.
For example, we can chain together three functions to:</p>
<ul class="simple">
<li><p>extract rows (<code class="docutils literal notranslate"><span class="pre">df[]</span></code>) to include only those where the counts of the language most spoken at home are greater than 10,000,</p></li>
<li><p>extract only the columns (<code class="docutils literal notranslate"><span class="pre">.loc</span></code>) corresponding to <code class="docutils literal notranslate"><span class="pre">region</span></code>, <code class="docutils literal notranslate"><span class="pre">language</span></code> and <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code>, and</p></li>
<li><p>sort the data frame rows in order (<code class="docutils literal notranslate"><span class="pre">.sort_values</span></code>) by counts of the language most spoken at home
from smallest to largest.</p></li>
</ul>
<p>As we saw in Chapter <span class="xref std std-ref">intro</span>,
we can use the <code class="docutils literal notranslate"><span class="pre">.sort_values</span></code> function \index{arrange}
to order the rows in the data frame by the values of one or more columns.
Here we pass the column name <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> to sort the data frame rows by the values in that column, in ascending order.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">large_region_lang</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">tidy_lang</span><span class="p">[</span><span class="n">tidy_lang</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">10000</span><span class="p">]</span>
    <span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;language&quot;</span><span class="p">,</span> <span class="s2">&quot;most_at_home&quot;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">large_region_lang</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>language</th>
      <th>most_at_home</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>865</th>
      <td>Edmonton</td>
      <td>Arabic</td>
      <td>10590</td>
    </tr>
    <tr>
      <th>402</th>
      <td>Montréal</td>
      <td>Tamil</td>
      <td>10670</td>
    </tr>
    <tr>
      <th>584</th>
      <td>Vancouver</td>
      <td>Russian</td>
      <td>10795</td>
    </tr>
    <tr>
      <th>1034</th>
      <td>Edmonton</td>
      <td>Spanish</td>
      <td>10880</td>
    </tr>
    <tr>
      <th>915</th>
      <td>Edmonton</td>
      <td>French</td>
      <td>10950</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>910</th>
      <td>Edmonton</td>
      <td>English</td>
      <td>1050410</td>
    </tr>
    <tr>
      <th>696</th>
      <td>Calgary</td>
      <td>English</td>
      <td>1065070</td>
    </tr>
    <tr>
      <th>482</th>
      <td>Vancouver</td>
      <td>English</td>
      <td>1622735</td>
    </tr>
    <tr>
      <th>273</th>
      <td>Montréal</td>
      <td>French</td>
      <td>2669195</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Toronto</td>
      <td>English</td>
      <td>3836770</td>
    </tr>
  </tbody>
</table>
<p>67 rows × 3 columns</p>
</div></div></div>
</div>
<p>Now that we’ve shown you chaining as an alternative to storing
temporary objects and composing code, does this mean you should <em>never</em> store
temporary objects or compose code? Not necessarily!
There are times when you will still want to do these things.
For example, you might store a temporary object before feeding it into a plot function
so you can iteratively change the plot without having to
redo all of your data transformations.
Additionally, chaining many functions can be overwhelming and difficult to debug;
you may want to store a temporary object midway through to inspect your result
before moving on with further steps.</p>
</div>
</div>
<div class="section" id="aggregating-data-with-assign-agg-and-apply">
<h2>Aggregating data with <code class="docutils literal notranslate"><span class="pre">.assign</span></code>, <code class="docutils literal notranslate"><span class="pre">.agg</span></code> and <code class="docutils literal notranslate"><span class="pre">.apply</span></code><a class="headerlink" href="#aggregating-data-with-assign-agg-and-apply" title="Permalink to this headline">¶</a></h2>
<div class="section" id="calculating-summary-statistics-on-whole-columns">
<h3>Calculating summary statistics on whole columns<a class="headerlink" href="#calculating-summary-statistics-on-whole-columns" title="Permalink to this headline">¶</a></h3>
<p>As a part of many data analyses, we need to calculate a summary value for the
data (a <em>summary statistic</em>). \index{summarize}
Examples of summary statistics we might want to calculate
are the number of observations, the average/mean value for a column,
the minimum value, etc.
Oftentimes,
this summary statistic is calculated from the values in a data frame column,
or columns, as shown in <a class="reference internal" href="#fig-summarize"><span class="std std-numref">Fig. 24</span></a>.</p>
<div class="caption-hack figure align-default" id="fig-summarize">
<img alt="_images/summarize.001.jpeg" src="_images/summarize.001.jpeg" />
<p class="caption"><span class="caption-number">Fig. 24 </span><span class="caption-text">Calculating summary statistics on one or more column(s). In its simplest use case, it creates a new data frame with a single row containing the summary statistic(s) for each column being summarized. The darker, top row of each table represents the column headers.</span><a class="headerlink" href="#fig-summarize" title="Permalink to this image">¶</a></p>
</div>
<p>We can use <code class="docutils literal notranslate"><span class="pre">.assign</span></code> as mentioned in Section <a class="reference internal" href="#pandas-assign"><span class="std std-ref">Using .assign to modify or add columns</span></a> along with proper summary functions to create a aggregated column.</p>
<p>First a reminder of what <code class="docutils literal notranslate"><span class="pre">region_lang</span></code> looks like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/region_lang.csv&quot;</span><span class="p">)</span>
<span class="n">region_lang</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>St. John's</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Halifax</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Moncton</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Saint John</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Saguenay</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7485</th>
      <td>Ottawa - Gatineau</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>265</td>
      <td>65</td>
      <td>10</td>
      <td>910</td>
    </tr>
    <tr>
      <th>7486</th>
      <td>Kelowna</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7487</th>
      <td>Abbotsford - Mission</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
    </tr>
    <tr>
      <th>7488</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>190</td>
      <td>40</td>
      <td>0</td>
      <td>505</td>
    </tr>
    <tr>
      <th>7489</th>
      <td>Victoria</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
<p>7490 rows × 7 columns</p>
</div></div></div>
</div>
<p>We apply <code class="docutils literal notranslate"><span class="pre">min</span></code> to calculate the minimum
and <code class="docutils literal notranslate"><span class="pre">max</span></code> to calculate maximum number of Canadians
reporting a particular language as their primary language at home,
for any region, and <code class="docutils literal notranslate"><span class="pre">.assign</span></code> a column name to each:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lang_summary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">lang_summary</span> <span class="o">=</span> <span class="n">lang_summary</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">min_most_at_home</span><span class="o">=</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">region_lang</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">])])</span>
<span class="n">lang_summary</span> <span class="o">=</span> <span class="n">lang_summary</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">max_most_at_home</span><span class="o">=</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">region_lang</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">])])</span>
<span class="n">lang_summary</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min_most_at_home</th>
      <th>max_most_at_home</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>3836770</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>From this we see that there are some languages in the data set that no one speaks
as their primary language at home. We also see that the most commonly spoken
primary language at home is spoken by
<span class="pasted-text">3,836,770</span>
people.</p>
</div>
<div class="section" id="calculating-summary-statistics-when-there-are-nans">
<h3>Calculating summary statistics when there are <code class="docutils literal notranslate"><span class="pre">NaN</span></code>s<a class="headerlink" href="#calculating-summary-statistics-when-there-are-nans" title="Permalink to this headline">¶</a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">pandas</span></code> DataFrame, the value <code class="docutils literal notranslate"><span class="pre">NaN</span></code> is often used to denote missing data.
Many of the base python statistical summary functions
(e.g., <code class="docutils literal notranslate"><span class="pre">max</span></code>, <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">sum</span></code>, etc) will return <code class="docutils literal notranslate"><span class="pre">NaN</span></code>
when applied to columns containing <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values. \index{missing data}\index{NA|see{missing data}}
Usually that is not what we want to happen;
instead, we would usually like Python to ignore the missing entries
and calculate the summary statistic using all of the other non-<code class="docutils literal notranslate"><span class="pre">NaN</span></code> values
in the column.
Fortunately <code class="docutils literal notranslate"><span class="pre">pandas</span></code> provides many equivalent methods (e.g., <code class="docutils literal notranslate"><span class="pre">.max</span></code>, <code class="docutils literal notranslate"><span class="pre">.min</span></code>, <code class="docutils literal notranslate"><span class="pre">.sum</span></code>, etc) to
these summary functions while providing an extra argument <code class="docutils literal notranslate"><span class="pre">skipna</span></code> that lets
us tell the function what to do when it encounters <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values.
In particular, if we specify <code class="docutils literal notranslate"><span class="pre">skipna=True</span></code> (default), the function will ignore
missing values and return a summary of all the non-missing entries.
We show an example of this below.</p>
<p>First we create a new version of the <code class="docutils literal notranslate"><span class="pre">region_lang</span></code> data frame,
named <code class="docutils literal notranslate"><span class="pre">region_lang_na</span></code>, that has a seemingly innocuous <code class="docutils literal notranslate"><span class="pre">NaN</span></code>
in the first row of the <code class="docutils literal notranslate"><span class="pre">most_at_home</span></code> column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang_na</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>St. John's</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Halifax</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Moncton</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Saint John</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>0</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Saguenay</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>5.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7485</th>
      <td>Ottawa - Gatineau</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>265</td>
      <td>65.0</td>
      <td>10</td>
      <td>910</td>
    </tr>
    <tr>
      <th>7486</th>
      <td>Kelowna</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>5</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7487</th>
      <td>Abbotsford - Mission</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>20</td>
      <td>0.0</td>
      <td>0</td>
      <td>50</td>
    </tr>
    <tr>
      <th>7488</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>190</td>
      <td>40.0</td>
      <td>0</td>
      <td>505</td>
    </tr>
    <tr>
      <th>7489</th>
      <td>Victoria</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>20</td>
      <td>0.0</td>
      <td>0</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
<p>7490 rows × 7 columns</p>
</div></div></div>
</div>
<p>Now if we apply the Python built-in summary function as above,
we see that we no longer get the minimum and maximum returned,
but just an <code class="docutils literal notranslate"><span class="pre">NaN</span></code> instead!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lang_summary_na</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">lang_summary_na</span> <span class="o">=</span> <span class="n">lang_summary_na</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">min_most_at_home</span><span class="o">=</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">region_lang_na</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">])]</span>
<span class="p">)</span>
<span class="n">lang_summary_na</span> <span class="o">=</span> <span class="n">lang_summary_na</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">max_most_at_home</span><span class="o">=</span><span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="n">region_lang_na</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">])]</span>
<span class="p">)</span>
<span class="n">lang_summary_na</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min_most_at_home</th>
      <th>max_most_at_home</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can fix this by using the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> Series methods (<em>i.e.</em> <code class="docutils literal notranslate"><span class="pre">.min</span></code> and <code class="docutils literal notranslate"><span class="pre">.max</span></code>) with <code class="docutils literal notranslate"><span class="pre">skipna=True</span></code> as explained above:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lang_summary_na</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">lang_summary_na</span> <span class="o">=</span> <span class="n">lang_summary_na</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">min_most_at_home</span><span class="o">=</span><span class="p">[</span><span class="n">region_lang_na</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
<span class="p">)</span>
<span class="n">lang_summary_na</span> <span class="o">=</span> <span class="n">lang_summary_na</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">max_most_at_home</span><span class="o">=</span><span class="p">[</span><span class="n">region_lang_na</span><span class="p">[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
<span class="p">)</span>
<span class="n">lang_summary_na</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min_most_at_home</th>
      <th>max_most_at_home</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>3836770.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="calculating-summary-statistics-for-groups-of-rows">
<h3>Calculating summary statistics for groups of rows<a class="headerlink" href="#calculating-summary-statistics-for-groups-of-rows" title="Permalink to this headline">¶</a></h3>
<p>A common pairing with summary functions is <code class="docutils literal notranslate"><span class="pre">.groupby</span></code>. Pairing these functions \index{group_by}
together can let you summarize values for subgroups within a data set,
as illustrated in <a class="reference internal" href="#fig-summarize-groupby"><span class="std std-numref">Fig. 25</span></a>.
For example, we can use <code class="docutils literal notranslate"><span class="pre">.groupby</span></code> to group the regions of the <code class="docutils literal notranslate"><span class="pre">tidy_lang</span></code> data frame and then calculate the minimum and maximum number of Canadians
reporting the language as the primary language at home
for each of the regions in the data set.</p>
<div class="caption-hack figure align-default" id="fig-summarize-groupby">
<img alt="_images/summarize.002.jpeg" src="_images/summarize.002.jpeg" />
<p class="caption"><span class="caption-number">Fig. 25 </span><span class="caption-text">Calculating summary statistics on one or more column(s) for each group. It creates a new data frame—with one row for each group—containing the summary statistic(s) for each column being summarized. It also creates a column listing the value of the grouping variable. The darker, top row of each table represents the column headers. The gray, blue, and green colored rows correspond to the rows that belong to each of the three groups being represented in this cartoon example.</span><a class="headerlink" href="#fig-summarize-groupby" title="Permalink to this image">¶</a></p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">.groupby</span></code> function takes at least one argument—the columns to use in the
grouping. Here we use only one column for grouping (<code class="docutils literal notranslate"><span class="pre">region</span></code>), but more than one
can also be used. To do this, pass a list of column names to the <code class="docutils literal notranslate"><span class="pre">by</span></code> argument.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_summary</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">region_summary</span> <span class="o">=</span> <span class="n">region_summary</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">min_most_at_home</span><span class="o">=</span><span class="n">region_lang</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">)[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
    <span class="n">max_most_at_home</span><span class="o">=</span><span class="n">region_lang</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">)[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">region_summary</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;min_most_at_home&quot;</span><span class="p">,</span> <span class="s2">&quot;max_most_at_home&quot;</span><span class="p">]</span>
<span class="n">region_summary</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>min_most_at_home</th>
      <th>max_most_at_home</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Abbotsford - Mission</td>
      <td>0</td>
      <td>137445</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Barrie</td>
      <td>0</td>
      <td>182390</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Belleville</td>
      <td>0</td>
      <td>97840</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Brantford</td>
      <td>0</td>
      <td>124560</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Calgary</td>
      <td>0</td>
      <td>1065070</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Trois-Rivières</td>
      <td>0</td>
      <td>149835</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Vancouver</td>
      <td>0</td>
      <td>1622735</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Victoria</td>
      <td>0</td>
      <td>331375</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Windsor</td>
      <td>0</td>
      <td>270715</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Winnipeg</td>
      <td>0</td>
      <td>612595</td>
    </tr>
  </tbody>
</table>
<p>35 rows × 3 columns</p>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pandas</span></code> also has a convenient method <code class="docutils literal notranslate"><span class="pre">.agg</span></code> (shorthand for <code class="docutils literal notranslate"><span class="pre">.aggregate</span></code>) that allows us to apply multiple aggregate functions in one line of code. We just need to pass in a list of function names to <code class="docutils literal notranslate"><span class="pre">.agg</span></code> as shown below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_summary</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">region_lang</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;region&quot;</span><span class="p">)[</span><span class="s2">&quot;most_at_home&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">([</span><span class="s2">&quot;min&quot;</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">region_summary</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">,</span> <span class="s2">&quot;min_most_at_home&quot;</span><span class="p">,</span> <span class="s2">&quot;max_most_at_home&quot;</span><span class="p">]</span>
<span class="n">region_summary</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>min_most_at_home</th>
      <th>max_most_at_home</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Abbotsford - Mission</td>
      <td>0</td>
      <td>137445</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Barrie</td>
      <td>0</td>
      <td>182390</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Belleville</td>
      <td>0</td>
      <td>97840</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Brantford</td>
      <td>0</td>
      <td>124560</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Calgary</td>
      <td>0</td>
      <td>1065070</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Trois-Rivières</td>
      <td>0</td>
      <td>149835</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Vancouver</td>
      <td>0</td>
      <td>1622735</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Victoria</td>
      <td>0</td>
      <td>331375</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Windsor</td>
      <td>0</td>
      <td>270715</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Winnipeg</td>
      <td>0</td>
      <td>612595</td>
    </tr>
  </tbody>
</table>
<p>35 rows × 3 columns</p>
</div></div></div>
</div>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">.groupby</span></code> converts a <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> object to a <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> object, which contains information about the groups of the dataframe. We can then apply aggregating functions to the <code class="docutils literal notranslate"><span class="pre">DataFrameGroupBy</span></code> object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;region&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x16da8ea30&gt;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="calculating-summary-statistics-on-many-columns">
<h3>Calculating summary statistics on many columns<a class="headerlink" href="#calculating-summary-statistics-on-many-columns" title="Permalink to this headline">¶</a></h3>
<p>Sometimes we need to summarize statistics across many columns.
An example of this is illustrated in <a class="reference internal" href="#fig-summarize-across"><span class="std std-numref">Fig. 26</span></a>.
In such a case, using summary functions alone means that we have to
type out the name of each column we want to summarize.
In this section we will meet two strategies for performing this task.
First we will see how we can do this using <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code> to slice the columns before applying summary functions.
Then we will also explore how we can use a more general iteration function,
<code class="docutils literal notranslate"><span class="pre">.apply</span></code>, to also accomplish this.</p>
<div class="caption-hack figure align-default" id="fig-summarize-across">
<img alt="_images/summarize.003.jpeg" src="_images/summarize.003.jpeg" />
<p class="caption"><span class="caption-number">Fig. 26 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code> or <code class="docutils literal notranslate"><span class="pre">.apply</span></code> is useful for efficiently calculating summary statistics on many columns at once. The darker, top row of each table represents the column headers.</span><a class="headerlink" href="#fig-summarize-across" title="Permalink to this image">¶</a></p>
</div>
<div class="section" id="aggregating-on-a-data-frame-for-calculating-summary-statistics-on-many-columns">
<h4>Aggregating on a data frame for calculating summary statistics on many columns<a class="headerlink" href="#aggregating-on-a-data-frame-for-calculating-summary-statistics-on-many-columns" title="Permalink to this headline">¶</a></h4>
<p>Recall that in the Section <a class="reference internal" href="#loc-iloc"><span class="std std-ref">Using .loc[] and .iloc[] to extract a range of columns</span></a>, we can use <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code> to extract a range of columns with indices. Here we demonstrate finding the maximum value
of each of the numeric
columns of the <code class="docutils literal notranslate"><span class="pre">region_lang</span></code> data set through pairing <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code> and <code class="docutils literal notranslate"><span class="pre">.max</span></code>. This means that the
summary methods (<em>e.g.</em> <code class="docutils literal notranslate"><span class="pre">.min</span></code>, <code class="docutils literal notranslate"><span class="pre">.max</span></code>, <code class="docutils literal notranslate"><span class="pre">.sum</span></code> etc.) can be used for data frames as well.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">region_lang</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:]</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3061820</td>
      <td>3836770</td>
      <td>3218725</td>
      <td>5600480</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="apply-for-calculating-summary-statistics-on-many-columns">
<span id="apply-summary"></span><h4><code class="docutils literal notranslate"><span class="pre">.apply</span></code> for calculating summary statistics on many columns<a class="headerlink" href="#apply-for-calculating-summary-statistics-on-many-columns" title="Permalink to this headline">¶</a></h4>
<p>An alternative to aggregating on a dataframe
for applying a function to many columns is the <code class="docutils literal notranslate"><span class="pre">.apply</span></code> method.
Let’s again find the maximum value of each column of the
<code class="docutils literal notranslate"><span class="pre">region_lang</span></code> data frame, but using <code class="docutils literal notranslate"><span class="pre">.apply</span></code> with the <code class="docutils literal notranslate"><span class="pre">max</span></code> function this time.
We focus on the two arguments of <code class="docutils literal notranslate"><span class="pre">.apply</span></code>:
the function that you would like to apply to each column, and the <code class="docutils literal notranslate"><span class="pre">axis</span></code> along which the function will be applied (<code class="docutils literal notranslate"><span class="pre">0</span></code> for columns, <code class="docutils literal notranslate"><span class="pre">1</span></code> for rows).
Note that <code class="docutils literal notranslate"><span class="pre">.apply</span></code> does not have an argument
to specify <em>which</em> columns to apply the function to.
Therefore, we will use the <code class="docutils literal notranslate"><span class="pre">.iloc[]</span></code> before calling <code class="docutils literal notranslate"><span class="pre">.apply</span></code>
to choose the columns for which we want the maximum.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">region_lang</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">max</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3061820</td>
      <td>3836770</td>
      <td>3218725</td>
      <td>5600480</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<blockquote>
<div><p><strong>Note:</strong> Similar to when we use base Python statistical summary functions
(e.g., <code class="docutils literal notranslate"><span class="pre">max</span></code>, <code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">sum</span></code>, etc.) when there are <code class="docutils literal notranslate"><span class="pre">NaN</span></code>s,
<code class="docutils literal notranslate"><span class="pre">.apply</span></code> functions paired with base Python statistical summary functions
also return <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values when we apply them to columns that
contain <code class="docutils literal notranslate"><span class="pre">NaN</span></code> values. \index{missing data}</p>
<p>To avoid this, again we need to use the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> variants of summary functions (<em>i.e.</em>
<code class="docutils literal notranslate"><span class="pre">.max</span></code>, <code class="docutils literal notranslate"><span class="pre">.min</span></code>, <code class="docutils literal notranslate"><span class="pre">.sum</span></code>, etc.) with <code class="docutils literal notranslate"><span class="pre">skipna=True</span></code>.
When we use this with <code class="docutils literal notranslate"><span class="pre">.apply</span></code>, we do this by constructing a anonymous function that calls
the <code class="docutils literal notranslate"><span class="pre">.max</span></code> method with <code class="docutils literal notranslate"><span class="pre">skipna=True</span></code>, as illustrated below:</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">region_lang_na</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">col</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3061820.0</td>
      <td>3836770.0</td>
      <td>3218725.0</td>
      <td>5600480.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">.apply</span></code> function is generally quite useful for solving many problems
involving repeatedly applying functions in Python.
Additionally, a variant of <code class="docutils literal notranslate"><span class="pre">.apply</span></code> is <code class="docutils literal notranslate"><span class="pre">.applymap</span></code>,
which can be used to apply functions element-wise.
To learn more about these functions, see the additional resources
section at the end of this chapter.</p>
</div>
</div>
</div>
<div class="section" id="apply-functions-across-many-columns-with-apply">
<h2>Apply functions across many columns with <code class="docutils literal notranslate"><span class="pre">.apply</span></code><a class="headerlink" href="#apply-functions-across-many-columns-with-apply" title="Permalink to this headline">¶</a></h2>
<p>Sometimes we need to apply a function to many columns in a data frame.
For example, we would need to do this when converting units of measurements across many columns.
We illustrate such a data transformation in <a class="reference internal" href="#fig-mutate-across"><span class="std std-numref">Fig. 27</span></a>.</p>
<div class="caption-hack figure align-default" id="fig-mutate-across">
<img alt="_images/summarize.005.jpeg" src="_images/summarize.005.jpeg" />
<p class="caption"><span class="caption-number">Fig. 27 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">.apply</span></code> is useful for applying functions across many columns. The darker, top row of each table represents the column headers.</span><a class="headerlink" href="#fig-mutate-across" title="Permalink to this image">¶</a></p>
</div>
<p>For example,
imagine that we wanted to convert all the numeric columns
in the <code class="docutils literal notranslate"><span class="pre">region_lang</span></code> data frame from <code class="docutils literal notranslate"><span class="pre">int64</span></code> type to <code class="docutils literal notranslate"><span class="pre">int32</span></code> type
using the <code class="docutils literal notranslate"><span class="pre">.as_type</span></code> function.
When we revisit the <code class="docutils literal notranslate"><span class="pre">region_lang</span></code> data frame,
we can see that this would be the columns from <code class="docutils literal notranslate"><span class="pre">mother_tongue</span></code> to <code class="docutils literal notranslate"><span class="pre">lang_known</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>St. John's</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Halifax</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Moncton</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Saint John</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Saguenay</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7485</th>
      <td>Ottawa - Gatineau</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>265</td>
      <td>65</td>
      <td>10</td>
      <td>910</td>
    </tr>
    <tr>
      <th>7486</th>
      <td>Kelowna</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7487</th>
      <td>Abbotsford - Mission</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
    </tr>
    <tr>
      <th>7488</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>190</td>
      <td>40</td>
      <td>0</td>
      <td>505</td>
    </tr>
    <tr>
      <th>7489</th>
      <td>Victoria</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
<p>7490 rows × 7 columns</p>
</div></div></div>
</div>
<p>To accomplish such a task, we can use <code class="docutils literal notranslate"><span class="pre">.apply</span></code>.
This works in a similar way for column selection,
as we saw when we used in Section <a class="reference internal" href="#apply-summary"><span class="std std-ref">.apply for calculating summary statistics on many columns</span></a> earlier.
As we did above,
we again use <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> to specify the columns
as well as the <code class="docutils literal notranslate"><span class="pre">.apply</span></code> to specify the function we want to apply on these columns.
However, a key difference here is that we are not using aggregating function here,
which means that we get back a data frame with the same number of rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region           object
category         object
language         object
mother_tongue     int64
most_at_home      int64
most_at_work      int64
lang_known        int64
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang_int32</span> <span class="o">=</span> <span class="n">region_lang</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">col</span><span class="p">:</span> <span class="n">col</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">region_lang_int32</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">region_lang</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">],</span> <span class="n">region_lang_int32</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">region_lang_int32</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>St. John's</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Halifax</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Moncton</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Saint John</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Saguenay</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7485</th>
      <td>Ottawa - Gatineau</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>265</td>
      <td>65</td>
      <td>10</td>
      <td>910</td>
    </tr>
    <tr>
      <th>7486</th>
      <td>Kelowna</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7487</th>
      <td>Abbotsford - Mission</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
    </tr>
    <tr>
      <th>7488</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>190</td>
      <td>40</td>
      <td>0</td>
      <td>505</td>
    </tr>
    <tr>
      <th>7489</th>
      <td>Victoria</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
<p>7490 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang_int32</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>region           object
category         object
language         object
mother_tongue     int32
most_at_home      int32
most_at_work      int32
lang_known        int32
dtype: object
</pre></div>
</div>
</div>
</div>
<p>We see that we get back a data frame
with the same number of columns and rows.
The only thing that changes is the transformation we applied
to the specified columns (here <code class="docutils literal notranslate"><span class="pre">mother_tongue</span></code> to <code class="docutils literal notranslate"><span class="pre">lang_known</span></code>).</p>
</div>
<div class="section" id="apply-functions-across-columns-within-one-row-with-apply">
<h2>Apply functions across columns within one row with <code class="docutils literal notranslate"><span class="pre">.apply</span></code><a class="headerlink" href="#apply-functions-across-columns-within-one-row-with-apply" title="Permalink to this headline">¶</a></h2>
<p>What if you want to apply a function across columns but within one row?
We illustrate such a data transformation in <a class="reference internal" href="#fig-rowwise"><span class="std std-numref">Fig. 28</span></a>.</p>
<div class="caption-hack figure align-default" id="fig-rowwise">
<img alt="_images/summarize.004.jpeg" src="_images/summarize.004.jpeg" />
<p class="caption"><span class="caption-number">Fig. 28 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">.apply</span></code> is useful for applying functions across columns within one row. The darker, top row of each table represents the column headers.</span><a class="headerlink" href="#fig-rowwise" title="Permalink to this image">¶</a></p>
</div>
<p>For instance, suppose we want to know the maximum value between <code class="docutils literal notranslate"><span class="pre">mother_tongue</span></code>,
<code class="docutils literal notranslate"><span class="pre">most_at_home</span></code>, <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code>
and <code class="docutils literal notranslate"><span class="pre">lang_known</span></code> for each language and region
in the <code class="docutils literal notranslate"><span class="pre">region_lang</span></code> data set.
In other words, we want to apply the <code class="docutils literal notranslate"><span class="pre">max</span></code> function <em>row-wise.</em>
Before we use <code class="docutils literal notranslate"><span class="pre">.apply</span></code>, we will again use <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> to select only the count columns
so we can see all the columns in the data frame’s output easily in the book.
So for this demonstration, the data set we are operating on looks like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7485</th>
      <td>265</td>
      <td>65</td>
      <td>10</td>
      <td>910</td>
    </tr>
    <tr>
      <th>7486</th>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7487</th>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
    </tr>
    <tr>
      <th>7488</th>
      <td>190</td>
      <td>40</td>
      <td>0</td>
      <td>505</td>
    </tr>
    <tr>
      <th>7489</th>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
<p>7490 rows × 4 columns</p>
</div></div></div>
</div>
<p>Now we use <code class="docutils literal notranslate"><span class="pre">.apply</span></code> with argument <code class="docutils literal notranslate"><span class="pre">axis=1</span></code>, to tell Python that we would like
the <code class="docutils literal notranslate"><span class="pre">max</span></code> function to be applied across, and within, a row,
as opposed to being applied on a column
(which is the default behavior of <code class="docutils literal notranslate"><span class="pre">.apply</span></code>):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">region_lang_rowwise</span> <span class="o">=</span> <span class="n">region_lang</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">maximum</span><span class="o">=</span><span class="n">region_lang</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">max</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">region_lang_rowwise</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>region</th>
      <th>category</th>
      <th>language</th>
      <th>mother_tongue</th>
      <th>most_at_home</th>
      <th>most_at_work</th>
      <th>lang_known</th>
      <th>maximum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>St. John's</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Halifax</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Moncton</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Saint John</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Saguenay</td>
      <td>Aboriginal languages</td>
      <td>Aboriginal languages, n.o.s.</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>7485</th>
      <td>Ottawa - Gatineau</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>265</td>
      <td>65</td>
      <td>10</td>
      <td>910</td>
      <td>910</td>
    </tr>
    <tr>
      <th>7486</th>
      <td>Kelowna</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>7487</th>
      <td>Abbotsford - Mission</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>50</td>
      <td>50</td>
    </tr>
    <tr>
      <th>7488</th>
      <td>Vancouver</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>190</td>
      <td>40</td>
      <td>0</td>
      <td>505</td>
      <td>505</td>
    </tr>
    <tr>
      <th>7489</th>
      <td>Victoria</td>
      <td>Non-Official &amp; Non-Aboriginal languages</td>
      <td>Yoruba</td>
      <td>20</td>
      <td>0</td>
      <td>0</td>
      <td>90</td>
      <td>90</td>
    </tr>
  </tbody>
</table>
<p>7490 rows × 8 columns</p>
</div></div></div>
</div>
<p>We see that we get an additional column added to the data frame,
named <code class="docutils literal notranslate"><span class="pre">maximum</span></code>, which is the maximum value between <code class="docutils literal notranslate"><span class="pre">mother_tongue</span></code>,
<code class="docutils literal notranslate"><span class="pre">most_at_home</span></code>, <code class="docutils literal notranslate"><span class="pre">most_at_work</span></code> and <code class="docutils literal notranslate"><span class="pre">lang_known</span></code> for each language
and region.</p>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Cleaning and wrangling data can be a very time-consuming process. However,
it is a critical step in any data analysis. We have explored many different
functions for cleaning and wrangling data into a tidy format.
<a class="reference internal" href="#tab-summary-functions-table"><span class="std std-numref">Table 5</span></a> summarizes some of the key wrangling
functions we learned in this chapter. In the following chapters, you will
learn how you can take this tidy data and do so much more with it to answer your
burning data science questions!</p>
<table class="colwidths-auto table" id="tab-summary-functions-table">
<caption><span class="caption-number">Table 5 </span><span class="caption-text">Summary of wrangling functions </span><a class="headerlink" href="#tab-summary-functions-table" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Function</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">.agg</span></code></p></td>
<td><p>calculates aggregated summaries of inputs</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">.apply</span></code></p></td>
<td><p>allows you to apply function(s) to multiple columns/rows</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">.assign</span></code></p></td>
<td><p>adds or modifies columns in a data frame</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">.groupby</span></code></p></td>
<td><p>allows you to apply function(s) to groups of rows</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">.iloc</span></code></p></td>
<td><p>subsets columns/rows of a data frame using integer indices</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">.loc</span></code></p></td>
<td><p>subsets columns/rows of a data frame using labels</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">.melt</span></code></p></td>
<td><p>generally makes the data frame longer and narrower</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">.pivot</span></code></p></td>
<td><p>generally makes a data frame wider and decreases the number of rows</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">.str.split</span></code></p></td>
<td><p>splits up a string column into multiple columns</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<p>Practice exercises for the material covered in this chapter
can be found in the accompanying
<a class="reference external" href="https://github.com/UBC-DSCI/data-science-a-first-intro-worksheets#readme">worksheets repository</a>
in the “Cleaning and wrangling data” row.
You can launch an interactive version of the worksheet in your browser by clicking the “launch binder” button.
You can also preview a non-interactive version of the worksheet by clicking “view worksheet.”
If you instead decide to download the worksheet and run it on your own machine,
make sure to follow the instructions for computer setup
found in Chapter <span class="xref std std-ref">move-to-your-own-machine</span>. This will ensure that the automated feedback
and guidance that the worksheets provide will function as intended.</p>
</div>
<div class="section" id="additional-resources">
<h2>Additional resources<a class="headerlink" href="#additional-resources" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>The <a class="reference external" href="https://pandas.pydata.org/docs/reference/index.html"><code class="docutils literal notranslate"><span class="pre">pandas</span></code> package documentation</a> is
another resource to learn more about the functions in this
chapter, the full set of arguments you can use, and other related functions.
The site also provides a very nice cheat sheet that summarizes many of the
data wrangling functions from this chapter.</p></li>
<li><p><em>Python for Data Analysis</em> <span id="id2">[<a class="reference internal" href="regression2.html#id50" title="Wes McKinney. Python for data analysis: Data wrangling with Pandas, NumPy, and IPython. &quot; O'Reilly Media, Inc.&quot;, 2012.">McKinney, 2012</a>]</span> has a few chapters related to
data wrangling that go into more depth than this book. For example, the
<a class="reference external" href="https://wesmckinney.com/book/data-wrangling.html">data wrangling chapter</a> covers tidy data,
<code class="docutils literal notranslate"><span class="pre">.melt</span></code> and <code class="docutils literal notranslate"><span class="pre">.pivot</span></code>, but also covers missing values
and additional wrangling functions (like <code class="docutils literal notranslate"><span class="pre">.stack</span></code>). The <a class="reference external" href="https://wesmckinney.com/book/data-aggregation.html">data
aggregation chapter</a> covers
<code class="docutils literal notranslate"><span class="pre">.groupby</span></code>, aggregating functions, <code class="docutils literal notranslate"><span class="pre">.apply</span></code>, etc.</p></li>
<li><p>You will occasionally encounter a case where you need to iterate over items
in a data frame, but none of the above functions are flexible enough to do
what you want. In that case, you may consider using <a class="reference external" href="https://wesmckinney.com/book/python-basics.html#control_for">a for
loop</a> <span id="id3">[<a class="reference internal" href="regression2.html#id50" title="Wes McKinney. Python for data analysis: Data wrangling with Pandas, NumPy, and IPython. &quot; O'Reilly Media, Inc.&quot;, 2012.">McKinney, 2012</a>]</span>.</p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="reading.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Reading in data locally and from the web</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="viz.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Effective data visualization</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By UBC<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>